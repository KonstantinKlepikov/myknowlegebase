<!DOCTYPE html>
<html lang="ru_RU">

  <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Jina | My knowledge base</title>
<meta name="generator" content="Jekyll v3.8.7" />
<meta property="og:title" content="Jina" />
<meta property="og:locale" content="ru_RU" />
<meta name="description" content="Фреймворк для работы с ml-моделями" />
<meta property="og:description" content="Фреймворк для работы с ml-моделями" />
<link rel="canonical" href="https://konstantinklepikov.github.io/myknowlegebase/notes/jina.html" />
<meta property="og:url" content="https://konstantinklepikov.github.io/myknowlegebase/notes/jina.html" />
<meta property="og:site_name" content="My knowledge base" />
<script type="application/ld+json">
{"description":"Фреймворк для работы с ml-моделями","@type":"WebPage","url":"https://konstantinklepikov.github.io/myknowlegebase/notes/jina.html","headline":"Jina","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <meta name="keywords" content="">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

    
    
    <link rel="stylesheet" href="https://konstantinklepikov.github.io/myknowlegebase/assets/style.css">
    <script async defer src="https://buttons.github.io/buttons.js"></script>

    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->


      <!-- Yandex.Metrika counter -->
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(53548570, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true
    });
  </script>
  <noscript><div><img src="https://mc.yandex.ru/watch/53548570" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->
      <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-139620627-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-139620627-1');
  </script>


<!-- Favicon -->
<link rel="icon" href="https://konstantinklepikov.github.io/myknowlegebase/assets/img/favicon.ico" type="image/x-icon">
<link rel="shortcut icon" href="https://konstantinklepikov.github.io/myknowlegebase/assets/img/favicon.ico" type="image/x-icon">

<!-- Math support -->
<!-- Mathjax Support -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>

<!-- tags collection-->

    







<!-- end custom head snippets -->

</head>

  <body>

    <header class="border-bottom-thick px-2 clearfix">
    <div class="left sm-width-full py-1 mt-1 mt-lg-0">
      <a class="align-middle link-primary text-accent" href="https://konstantinklepikov.github.io/">
        My deep learning
      </a>
    </div>
    <div class="right sm-width-full">
      <ul class="list-reset mt-lg-1 mb-2 mb-lg-1">
        <li class="inline-block">
          <a class="align-middle link-primary mr-2 mr-lg-0 ml-lg-2" href="/myknowlegebase/">
            My knowledge base
          </a>
        </li>
      </ul>
    </div>
  </header>

    <main role="main">

      
<article class="container mx-auto px-2 mt2 mb4">
  <header>
    <h1 class="h1 col-9 sm-width-full py-4 mt-3 inline-block" itemprop="name headline">Jina</h1>
  </header>
  <div class="col-4 sm-width-full border-top-thin">
    <p class="mb-3 h5">Теги:
      
        
        <a href="/myknowlegebase/tag/machine-learning" title="machine-learning" class="link-tags">machine-learning&nbsp;</a>
      
        
        <a href="/myknowlegebase/tag/python" title="python" class="link-tags">python&nbsp;</a>
      
    </p>
  </div>
  <div>
    <script type="text/javascript"> function googleTranslateElementInit() { new google.translate.TranslateElement({pageLanguage: 'ru'}, 'google_translate_element'); } </script> <script type="text/javascript" src="//[translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
  </div>
  <div class="prose mb-4 py-4">
    <p>Jina — это платформа нейронного поиска, которая позволяет любому создавать SOTA и масштабируемые приложения нейронного поиска за считанные минуты.</p>

<p>Основная идея нейронного поиска заключается в использовании самых современных глубоких нейронных сетей для создания каждого компонента поисковой системы. Короче говоря, нейронный поиск — это глубокий поиск информации с помощью нейронной сети. Jina обеспечивает расширенный анализ всех видов неструктурированных данных, таких как изображения, аудио, видео, PDF, 3D.</p>

<p>Jina использует DocArray в качестве основной структуры данных; Jina Hub для совместного использования, контейнеризации и повторного использования компонентов поисковых конвейеров. Jina разработана как компактная и простая в использовании структура. Есть только две основные концепции, которые нужно изучить:</p>

<ul>
  <li>Executor является самодостаточным компонентом и выполняет группу задач над документами.</li>
  <li>Flow объединяет исполнителей в конвейер обработки, обеспечивает масштабируемость и упрощает развертывание в облаке.</li>
</ul>

<h2 id="start-project">Start project</h2>

<p><code class="language-plaintext highlighter-rouge">pip install -U jina</code></p>

<p><code class="language-plaintext highlighter-rouge">jina new hello-jina</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hello</span><span class="o">-</span><span class="n">jina</span>
<span class="o">|-</span> <span class="n">app</span><span class="p">.</span><span class="n">py</span>
<span class="o">|-</span> <span class="n">executor1</span><span class="o">/</span>
        <span class="o">|-</span> <span class="n">config</span><span class="p">.</span><span class="n">yml</span>
        <span class="o">|-</span> <span class="n">executor</span><span class="p">.</span><span class="n">py</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">app.py</code> is the entrypoint of your Jina project. You can run it via python <code class="language-plaintext highlighter-rouge">app.py</code></li>
  <li><code class="language-plaintext highlighter-rouge">executor1/</code> is where we’ll write our Executor code</li>
  <li><code class="language-plaintext highlighter-rouge">config.yml</code> is the config file for the Executor. It’s where you keep metadata for your Executor, as well as dependencies</li>
</ul>

<p><a href="https://docs.jina.ai/get-started/create-app/">как создать проект гайд</a></p>

<h2 id="docarray">DocArray</h2>

<p><a href="https://docarray.jina.ai/?utm_source=jina">DocArray</a></p>

<p>DocArray — это библиотека для вложенных, неструктурированных данных в пути, включая текст, изображения, аудио, видео и т. д. Он позволяет инженерам глубокого обучения эффективно обрабатывать, внедрять, искать, рекомендовать, хранить и передавать данные с помощью python API.</p>

<ul>
  <li>сверхвыразительная структура данных для представления сложного/смешанного/вложенного текста, изображений, видео, аудио, данных 3D</li>
  <li>разработан так, чтобы быть таким же простым, как список Python</li>
  <li>оптимизирован для сетевой связи, готов к подключению в любое время благодаря быстрой и сжатой сериализации в Protobuf, байтах, base64, JSON, CSV, DataFrame</li>
  <li>работайте с данными, не занимающими память, с помощью хранилища документов на диске, сохраняя при этом тот же опыт работы с API. Поддержка классических баз данных и векторных баз данных для более быстрого поиска</li>
  <li>поддержка [<a href="graphql" title="Язык и система организации АПИ GraphQL">graphql</a>] делает ваш сервер универсальным по запросу и ответу; встроенная проверка данных и схема JSON (OpenAPI) помогают создавать надежные веб-сервисы</li>
  <li>интеграция с ИДЕ</li>
</ul>

<h3 id="document">Document</h3>

<p><img src="/myknowlegebase/attachments/2022-05-14-01-11-11.png" alt="Document" /></p>

<p>Объект Document имеет <a href="https://docarray.jina.ai/fundamentals/document">предопределенную схему данных</a>. Как <a href="https://docarray.jina.ai/fundamentals/document/construct/?utm_source=docarray">работать с документом</a>.</p>

<h3 id="documentarray">DocumentArray</h3>

<p>DocumentArray представляет собой контейнер объектов, похожий на список. Это лучший способ при работе с несколькими документами. Он реализует все списковые интерфейсы. Он также мощный, как Numpy ndarray и Pandas DataFrame, позволяя вам эффективно получать доступ к элементам и атрибутам содержащихся документов. Кроме того доступны расширенные функции DocumentArray. Эти функции значительно ускоряют работу специалистов по обработке и анализу данных при доступе к вложенным элементам, оценке, визуализации, параллельных вычислениях, сериализации, сопоставлении и т. д. Если ваши данные слишком велики и не помещаются в память, вы можете просто переключиться на хранилище документов на диске или в удаленном хранилище . Все API и пользовательский интерфейс остаются прежними.</p>

<p>Смотри [<a href="docarray" title="Docarray python">docarray</a>]</p>

<p><a href="https://docarray.jina.ai/fundamentals/documentarray/construct/?utm_source=docarray">Как работать</a></p>

<h3 id="dataclass">Dataclass</h3>

<p>Предоставляет АПИ для работы с мультимодальными данными. Продолжает идиому python датаклассов. <a href="https://docarray.jina.ai/fundamentals/dataclass/?utm_source=docarray">Подробнее</a>.</p>

<p><img src="/myknowlegebase/attachments/2022-05-14-01-56-21.png" alt="dataclass" /></p>

<p><a href="https://docarray.jina.ai/fundamentals/dataclass/construct">API</a></p>

<h3 id="примеры-и-интеграция">Примеры и интеграция</h3>

<p><a href="https://docarray.jina.ai/datatypes">Примеры</a></p>

<p>Интеграции:</p>

<ul>
  <li>[<a href="sqlite" title="Sqlite bd">sqlite</a>] [и другие способы хранения]](https://docarray.jina.ai/advanced/document-store/)</li>
  <li><a href="https://docarray.jina.ai/fundamentals/notebook-support">jupyter notebook</a></li>
  <li><a href="https://docarray.jina.ai/advanced/torch-support">pytorch</a></li>
  <li>[<a href="fastapi" title="Fastapi">fastapi</a>]/[<a href="pydantic" title="Pydantic">pydantic</a>] <a href="https://docarray.jina.ai/fundamentals/fastapi-support">смотри тут</a></li>
  <li>[<a href="graphql" title="Язык и система организации АПИ GraphQL">graphql</a>] <a href="https://docarray.jina.ai/advanced/graphql-support">смотри тут</a></li>
</ul>

<h2 id="объекты-flow-и-executor">Объекты Flow и Executor</h2>

<p><img src="/myknowlegebase/attachments/2022-05-14-00-52-20.png" alt="flow and executor" /></p>

<p><strong>Gateway</strong>: Шлюз — это служба, запускаемая потоком, который отвечает за предоставление клиенту конечных точек WebSocker или gRPC. Это сервис, с которым будут общаться клиенты приложения. Кроме того, он сохраняет информацию о топологии потока, чтобы гарантировать, что исполнители Documents обрабатывают их в правильном порядке. Он связывается с развертываниями через gRPC</p>

<p><strong>Deployment</strong>: Развертывание — это абстракция вокруг Executor, которая позволяет Gateway взаимодействовать с Executors. Он инкапсулирует и абстрагирует детали внутренней репликации.</p>

<p><strong>Pod</strong>: Pod — это простая абстракция над средой выполнения, которая запускает любой сервис Jina, будь то процесс, контейнер Docker или Kubernetes Pod.</p>

<p><strong>Head</strong>: The Head — это служба, добавленная Jina в сегментированное развертывание. Она управляет связью с различными сегментами на основе настроенной стратегии опроса. Она общается с Executors через gRPC.</p>

<h3 id="executors">Executors</h3>

<ul>
  <li>позволяют организовать функции на основе <code class="language-plaintext highlighter-rouge">DocumentArray</code> в логические объекты, которые могут совместно использовать состояние конфигурации в соответствии с ООП</li>
  <li>преобразуют локальные функции в функции, которые можно распределять внутри потока</li>
  <li>внутри потока могут одновременно обрабатывать несколько массивов <code class="language-plaintext highlighter-rouge">DocumentArray</code> и легко развертываться в облаке как часть приложения нейронного поиска</li>
  <li>могут быть легко контейнеризированы и разделены с коллегами с помощью <code class="language-plaintext highlighter-rouge">jina hub push/pull</code></li>
</ul>

<p><a href="https://docs.jina.ai/fundamentals/executor/executor-api/">API of executors</a></p>

<p>Простейший пример:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Executor</span><span class="p">,</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="nn">asyncio</span>


<span class="k">class</span> <span class="nc">RequestExecutor</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
    <span class="o">@</span><span class="n">requests</span><span class="p">(</span>
        <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s">'/index'</span><span class="p">,</span> <span class="s">'/search'</span><span class="p">]</span>
    <span class="p">)</span>  <span class="c1"># foo will be bound to `/index` and `/search` endpoints
</span>    <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">f'Calling foo'</span><span class="p">)</span>

    <span class="o">@</span><span class="n">requests</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s">'/other'</span><span class="p">)</span>  <span class="c1"># bar will be bound to `/other` endpoint
</span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">f'Calling bar'</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Flow</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">Flow</span><span class="p">().</span><span class="n">add</span><span class="p">(</span><span class="n">uses</span><span class="o">=</span><span class="n">RequestExecutor</span><span class="p">)</span>

<span class="k">with</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s">'/index'</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[])</span>
    <span class="n">f</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s">'/other'</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[])</span>
    <span class="n">f</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s">'/search'</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div></div>

<p>Executor является автономным компонентом и выполняет группу задач с DocumentArray. Он инкапсулирует функции, обрабатывающие DocumentArrays. Внутри Executor эти функции декорируются <code class="language-plaintext highlighter-rouge">@requests</code>. Чтобы создать Executor, вам нужно всего лишь следовать трем принципам:</p>

<ul>
  <li>Executor должен быть подклассом непосредственно из класса <code class="language-plaintext highlighter-rouge">jina.Executor</code>.</li>
  <li>Класс Executor — это набор функций с общим состоянием или конфигурацией; он может содержать произвольное количество функций с произвольными именами.</li>
  <li>Функции, декорированные <code class="language-plaintext highlighter-rouge">@requests</code>, будут вызываться в соответствии с их эндпоинтом <code class="language-plaintext highlighter-rouge">on=</code> - во Flow ээто мапится в сетевые эндпоинты. Эти функции могут быть сопрограммами [<a href="asyncio" title="Asyncio">asyncio</a>] или обычными функциями.</li>
</ul>

<h4 id="__init__">__init__</h4>

<p>Если экзекьютор не содержит инициализируемого состояния - инт не нужен. Если содержит - необходимо вызвать кварги родителя:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Executor</span>


<span class="k">class</span> <span class="nc">MyExecutor</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foo</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">bar</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">().</span><span class="n">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">bar</span> <span class="o">=</span> <span class="n">bar</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">foo</span> <span class="o">=</span> <span class="n">foo</span>
</code></pre></div></div>

<h4 id="endpoints">Endpoints</h4>

<p>Эндпоитнты указывать не обязательно. Метод класса, декорированный <code class="language-plaintext highlighter-rouge">@requests</code> без on=, является обработчиком по умолчанию для всех конечных точек.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Executor</span><span class="p">,</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="nn">asyncio</span>


<span class="k">class</span> <span class="nc">MyExecutor</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
    <span class="o">@</span><span class="n">requests</span>
    <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="o">@</span><span class="n">requests</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s">'/index'</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">f'Calling bar'</span><span class="p">)</span>
</code></pre></div></div>

<p>Метод без привязки <code class="language-plaintext highlighter-rouge">@requests</code> не играет никакой роли в Flow. Все методы Executor, с <code class="language-plaintext highlighter-rouge">@requests</code>, должны следовать приведенной ниже сигнатуры аргументов, чтобы их можно было использовать во Flow.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">docarray</span> <span class="kn">import</span> <span class="n">DocumentArray</span>
<span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Executor</span><span class="p">,</span> <span class="n">requests</span>


<span class="k">class</span> <span class="nc">MyExecutor</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
    <span class="o">@</span><span class="n">requests</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">docs</span><span class="p">:</span> <span class="n">DocumentArray</span><span class="p">,</span>
        <span class="n">parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
        <span class="n">docs_matrix</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">DocumentArray</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">DocumentArray</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="bp">None</span><span class="p">]:</span>
        <span class="k">pass</span>
</code></pre></div></div>

<ul>
  <li>docs: DocumentArray, являющийся частью запроса. Поскольку природа Executor заключается в том, чтобы обернуть функциональность, связанную с DocumentArray, он обычно является основным процессорным блоком внутри методов Executor. Важно отметить, что DocumentArray могут быть изменены на месте, точно так же, как это может произойти с любым другим спископодобным объектом в функции Python.</li>
  <li>parameters: объект Dict, который можно использовать для передачи дополнительных параметров функциям Executor.</li>
  <li>docs_matrix: это наименее распространенный параметр, используемый для Executor. Этот аргумент необходим, когда Executor используется внутри потока для объединения или модификации вывода более чем одного другого Executor. Как пользователь, вы редко будете касаться этого параметра.</li>
</ul>

<p>Кажды экзекьютор может иметь ретурн трех типов:</p>

<ul>
  <li>Если вы вернете объект DocumentArray, он будет отправлен следующему исполнителю.</li>
  <li>Если вы возвращаете None, то исходный объект DocumentArray (возможно, измененный вашей функцией) будет отправлен следующему исполнителю.</li>
  <li>Если вы вернете объект dict, то он будет считаться результатом и будет передан в <code class="language-plaintext highlighter-rouge">parameters['__results__']</code>. Исходный объект документа (возможно, измененный вашей функцией) будет отправлен следующему исполнителю.</li>
</ul>

<h4 id="executors-and-flow">Executors and Flow</h4>

<p>Экзекьютор можно добваить во Flow <a href="https://docs.jina.ai/fundamentals/executor/yaml-spec/">через питоний АПИ или через yaml</a>. В этом учлае можно даже не декорировать методы через <code class="language-plaintext highlighter-rouge">@requests</code> - запрсоы можно прописат ьнепосредственно во Flow. Пример:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Executor</span>
<span class="kn">from</span> <span class="nn">docarray</span> <span class="kn">import</span> <span class="n">DocumentArray</span>


<span class="k">class</span> <span class="nc">MyExecutor</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter_1</span><span class="p">,</span> <span class="n">parameter_2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">().</span><span class="n">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">f'parameter_1 = </span><span class="si">{</span><span class="n">parameter_1</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">f'parameter_2 = </span><span class="si">{</span><span class="n">parameter_2</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">my_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="n">DocumentArray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'in my_index, bound to /index'</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">my_search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="n">DocumentArray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'in my_search, bound to /search'</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="n">DocumentArray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'in foo, bound to /random'</span><span class="p">)</span>


<span class="k">with</span> <span class="n">Flow</span><span class="p">().</span><span class="n">add</span><span class="p">(</span>
    <span class="n">uses</span><span class="o">=</span><span class="s">'MyExecutor'</span><span class="p">,</span>
    <span class="n">uses_with</span><span class="o">=</span><span class="p">{</span><span class="s">"parameter_1"</span><span class="p">:</span> <span class="s">"foo"</span><span class="p">,</span> <span class="s">"parameter_2"</span><span class="p">:</span> <span class="s">"bar"</span><span class="p">},</span>
    <span class="n">uses_metas</span><span class="o">=</span><span class="p">{</span>
        <span class="s">"name"</span><span class="p">:</span> <span class="s">"MyExecutor"</span><span class="p">,</span>
        <span class="s">"description"</span><span class="p">:</span> <span class="s">"MyExecutor does a thing to the stuff in your Documents"</span><span class="p">,</span>
        <span class="s">"py_modules"</span><span class="p">:</span> <span class="p">[</span><span class="s">"executor.py"</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">uses_requests</span><span class="o">=</span><span class="p">{</span><span class="s">"/index"</span><span class="p">:</span> <span class="s">"my_index"</span><span class="p">,</span> <span class="s">"/search"</span><span class="p">:</span> <span class="s">"my_search"</span><span class="p">,</span> <span class="s">"/random"</span><span class="p">:</span> <span class="s">"foo"</span><span class="p">},</span>
    <span class="n">workspace</span><span class="o">=</span><span class="s">"some_custom_path"</span><span class="p">,</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="p">...</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">use_with</code> — это словарь определяющий аргументы метода __init__ экзекьютора.</li>
  <li><code class="language-plaintext highlighter-rouge">uses_metas</code> — это словарь определяющий некоторые внутренние атрибуты экзекьютора. Он содержит следующие поля:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">name</code> — строка, определяющая имя исполнителя;</li>
      <li><code class="language-plaintext highlighter-rouge">description</code> — строка, определяющая описание этого исполнителя. Он будет использоваться в автодоках;</li>
      <li><code class="language-plaintext highlighter-rouge">py_modules</code> — это список строк, определяющих Python-зависимости исполнителя;</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">use_requests</code> — это словарь определяющий сопоставление эндпоинта с методом класса. Полезно, если нужно переопределить сопоставление эндпоинта и метода по умолчанию, определенное в реализации Executor.</li>
  <li><code class="language-plaintext highlighter-rouge">workspace</code> — строковое значение, определяющее рабочее пространство.</li>
</ul>

<p>Работа экзекютера в потоке завершается методом close(). Его можно переопределить.</p>

<p>Когда экзекьюто получает месседжы от нескольких других экзекьюторов в потоке, используется <code class="language-plaintext highlighter-rouge">docs_matrix</code></p>

<h4 id="executor-file-structure---лучшие-практики-организации-структуры-executorflow-приложения"><a href="https://docs.jina.ai/fundamentals/executor/executor-files/">Executor File Structure</a> - лучшие практики организации структуры executor/flow приложения</h4>

<h4 id="share-executors-via-jina-hub"><a href="https://docs.jina.ai/fundamentals/executor/hub/">Share Executors via Jina Hub</a></h4>

<h4 id="dockerize-your-executor"><a href="https://docs.jina.ai/fundamentals/executor/containerize-executor/">Dockerize your Executor</a></h4>

<h4 id="monitor-executor-with-custom-metrics"><a href="https://docs.jina.ai/fundamentals/executor/monitoring-executor/">Monitor Executor with Custom Metrics</a></h4>

<p>Jina позволяет контролировать каждую часть потока, включая Executor, с помощью Grafana/[<a href="prometeus" title="Prometeus">prometeus</a>].</p>

<p>Пользовательские метрики полезны, когда вы хотите отслеживать каждую часть экзекьюторов. Jina предоставляет декоратор <code class="language-plaintext highlighter-rouge">@monitor()</code>, который позволяет легко отслеживать подметоды Executor.</p>

<p>Когда мониторинг включен, каждый исполнитель будет предоставлять свои собственные показатели. Это означает, что на практике каждый из исполнителей будет предоставлять конечную точку Prometheus с помощью клиента Prometheus.</p>

<p>По умолчанию каждый метод, оформленный декоратором <code class="language-plaintext highlighter-rouge">@request</code>, будет отслеживаться, он создаст сводку Prometheus, в которой будет отслеживаться время выполнения метода.</p>

<h4 id="yaml-specification"><a href="https://docs.jina.ai/fundamentals/executor/yaml-spec/">YAML-specification</a></h4>

<h3 id="flow">Flow</h3>

<p><a href="https://docs.jina.ai/fundamentals/flow">API</a></p>

<p>Flow объединяет Exeturos в конвейер обработки для создания приложения. Документы движутся по созданному конвейеру и обрабатываются Executors. Можно думать о Flow как об интерфейсе для настройки и запуска микросервисной архитектуры, в то время как тяжелая работа выполняется самими сервисами. В частности, каждый поток также запускает службу шлюза, которая может предоставлять доступ ко всем другим службам через определенный API.</p>

<ul>
  <li>Потоки соединяют микрослужбы (исполнители) для создания службы с надлежащим интерфейсом в стиле клиент/сервер через HTTP, gRPC или Websocket</li>
  <li>Потоки позволяют независимо масштабировать этих исполнителей в соответствии с вашими требованиями</li>
  <li>Потоки позволяют легко использовать другие облачные оркестраторы, такие как Kubernetes, для управления вашим сервисом.</li>
</ul>

<p>Простейший пример:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">docarray</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Flow</span><span class="p">,</span> <span class="n">Executor</span><span class="p">,</span> <span class="n">requests</span>


<span class="k">class</span> <span class="nc">MyExecutor</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
    <span class="o">@</span><span class="n">requests</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s">'/bar'</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="n">docs</span><span class="p">)</span>


<span class="n">f</span> <span class="o">=</span> <span class="n">Flow</span><span class="p">().</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'myexec1'</span><span class="p">,</span> <span class="n">uses</span><span class="o">=</span><span class="n">MyExecutor</span><span class="p">)</span>

<span class="k">with</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s">'/bar'</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">Document</span><span class="p">(),</span> <span class="n">on_done</span><span class="o">=</span><span class="k">print</span><span class="p">)</span>
</code></pre></div></div>

<p>Поток определяет микросервисную архитектуру экзекьюторов. Вначале его необходимо инициализировать. Запуск потока производится с помощью контекстного менеджера. Исполнение потока можно прекратить с помощью метода <code class="language-plaintext highlighter-rouge">block()</code> - это блокирует выполнение текущего процесса или потока, что дает возможность внешним клиентам обращатсья к потоку. В примере ниже запускается поток, котоырй будет постоянно ожидать запросы.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Flow</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">Flow</span><span class="p">()</span>
<span class="k">with</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="p">.</span><span class="n">block</span><span class="p">()</span>
</code></pre></div></div>

<p><a href="https://docs.jina.ai/fundamentals/flow/create-flow/#start-and-stop-a-flow">Вариант блокировки через эвенты</a></p>

<p>Экзекьюторы добавляются в потко через АПИ python или <a href="https://docs.jina.ai/fundamentals/flow/yaml-spec/">с помощью yaml</a>. В апи используйте метод <code class="language-plaintext highlighter-rouge">add()</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">docarray</span> <span class="kn">import</span> <span class="n">Document</span><span class="p">,</span> <span class="n">DocumentArray</span>
<span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Executor</span><span class="p">,</span> <span class="n">Flow</span><span class="p">,</span> <span class="n">requests</span>


<span class="k">class</span> <span class="nc">FooExecutor</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
    <span class="o">@</span><span class="n">requests</span>
    <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="n">DocumentArray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">docs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">Document</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s">'foo was here'</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">BarExecutor</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
    <span class="o">@</span><span class="n">requests</span>
    <span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="n">DocumentArray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">docs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">Document</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s">'bar was here'</span><span class="p">))</span>


<span class="n">f</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Flow</span><span class="p">()</span>
    <span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">uses</span><span class="o">=</span><span class="n">FooExecutor</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'fooExecutor'</span><span class="p">)</span>
    <span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">uses</span><span class="o">=</span><span class="n">BarExecutor</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'barExecutor'</span><span class="p">)</span>
<span class="p">)</span>  <span class="c1"># Create the empty Flow
</span><span class="k">with</span> <span class="n">f</span><span class="p">:</span>  <span class="c1"># Using it as a Context Manager will start the Flow
</span>    <span class="n">response</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">post</span><span class="p">(</span>
        <span class="n">on</span><span class="o">=</span><span class="s">'/search'</span>
    <span class="p">)</span>  <span class="c1"># This sends a request to the /search endpoint of the Flow
</span>    <span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">texts</span><span class="p">)</span>
</code></pre></div></div>

<p>Можно добавлять экзекьюторы из кода приложения, jina-хаба, докерезированные экзекьюторы и из ямл-спецификаций. Кроме того, можно опрашивать сетевые адреса.</p>

<p>При инициализации потока параметры экзекьютора можно переопределить. <a href="https://docs.jina.ai/fundamentals/flow/add-executors/">Подробнее о добавлении экзекьюторов</a></p>

<p>Можно определять тип данных, в которых нужно сконвертировать аутпут экзекьютора, перед передачей в следующий в потоке. Это делается непосредственно в определении пайпалйна потока</p>

<p>Топология потока задается в виде графа и может включать определение обязательных зависимостей, фильтров, репликации экзекьюторов и машин. <a href="https://docs.jina.ai/fundamentals/flow/topologies/">Подробнее здесь</a></p>

<p>Визуализировать граф потока можно так:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Flow</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">Flow</span><span class="p">().</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'e1'</span><span class="p">).</span><span class="n">add</span><span class="p">(</span><span class="n">needs</span><span class="o">=</span><span class="s">'e1'</span><span class="p">).</span><span class="n">add</span><span class="p">(</span><span class="n">needs</span><span class="o">=</span><span class="s">'e1'</span><span class="p">)</span>
<span class="n">f</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="s">'flow-2.svg'</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/myknowlegebase/attachments/2022-05-31-00-02-31.png" alt="flow vizualisation" /></p>

<h2 id="gateway-and-client">Gateway and Client</h2>

<p>Сервер предоставляет эндпоинт, к которому можно обращаться клиентам.</p>

<p><img src="/myknowlegebase/attachments/2022-06-15-01-17-59.png" alt="gateway and client" /></p>

<p>Пример</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Server
</span><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">DocumentArray</span><span class="p">,</span> <span class="n">Executor</span><span class="p">,</span> <span class="n">Flow</span><span class="p">,</span> <span class="n">requests</span>


<span class="k">class</span> <span class="nc">FooExec</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
    <span class="o">@</span><span class="n">requests</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">add_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="n">DocumentArray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">docs</span><span class="p">:</span>
            <span class="n">d</span><span class="p">.</span><span class="n">text</span> <span class="o">+=</span> <span class="s">'hello, world!'</span>


<span class="k">class</span> <span class="nc">BarExec</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
    <span class="o">@</span><span class="n">requests</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">add_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="n">DocumentArray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">docs</span><span class="p">:</span>
            <span class="n">d</span><span class="p">.</span><span class="n">text</span> <span class="o">+=</span> <span class="s">'goodbye!'</span>


<span class="n">f</span> <span class="o">=</span> <span class="n">Flow</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="mi">12345</span><span class="p">).</span><span class="n">add</span><span class="p">(</span><span class="n">uses</span><span class="o">=</span><span class="n">FooExec</span><span class="p">,</span> <span class="n">replicas</span><span class="o">=</span><span class="mi">3</span><span class="p">).</span><span class="n">add</span><span class="p">(</span><span class="n">uses</span><span class="o">=</span><span class="n">BarExec</span><span class="p">,</span> <span class="n">replicas</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="k">with</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="p">.</span><span class="n">block</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># client
</span><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Client</span><span class="p">,</span> <span class="n">DocumentArray</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'/'</span><span class="p">,</span> <span class="n">DocumentArray</span><span class="p">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">texts</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="gateway"><a href="https://docs.jina.ai/fundamentals/gateway/">Gateway</a></h3>

<p>Каждый поток предоставляет шлюз API для приема запросов по сети. Поддерживаемые протоколы:</p>

<ul>
  <li>gRPC</li>
  <li>[<a href="../lists/http" title="Http">http</a>]</li>
  <li>WebSocket</li>
</ul>

<p>Пример с http (здесь использован <a href="https://docs.jina.ai/fundamentals/flow/client/">python client</a>)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">docarray</span> <span class="kn">import</span> <span class="n">Document</span><span class="p">,</span> <span class="n">DocumentArray</span>
<span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Client</span><span class="p">,</span> <span class="n">Executor</span><span class="p">,</span> <span class="n">Flow</span><span class="p">,</span> <span class="n">requests</span>


<span class="k">class</span> <span class="nc">FooExecutor</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
    <span class="o">@</span><span class="n">requests</span>
    <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="n">DocumentArray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">docs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">Document</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s">'foo was called'</span><span class="p">))</span>


<span class="n">f</span> <span class="o">=</span> <span class="n">Flow</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="s">'http'</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">12345</span><span class="p">).</span><span class="n">add</span><span class="p">(</span><span class="n">uses</span><span class="o">=</span><span class="n">FooExecutor</span><span class="p">)</span>
<span class="k">with</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="s">'http'</span><span class="p">)</span>
    <span class="n">docs</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s">'/'</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">docs</span><span class="p">.</span><span class="n">texts</span><span class="p">)</span>

<span class="p">[</span><span class="s">'foo was called'</span><span class="p">]</span>
</code></pre></div></div>

<p>Не каждый эндпоинт Executor будет автоматически доступен через внешний HTTP-интерфейс. По умолчанию любой поток предоставляет следующие эндпоинты CRUD и отладки HTTP: <code class="language-plaintext highlighter-rouge">/status</code>, <code class="language-plaintext highlighter-rouge">/post</code>, <code class="language-plaintext highlighter-rouge">/index</code>, <code class="language-plaintext highlighter-rouge">/search</code>, <code class="language-plaintext highlighter-rouge">/update</code> и <code class="language-plaintext highlighter-rouge">/delete</code>. Чтобы добавить кастомный эндпоинт в http-интерфейс, надо использовать <code class="language-plaintext highlighter-rouge">Flow.expose_endpoint</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Executor</span><span class="p">,</span> <span class="n">requests</span><span class="p">,</span> <span class="n">Flow</span>


<span class="k">class</span> <span class="nc">MyExec</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
    <span class="o">@</span><span class="n">requests</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s">'/foo'</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">pass</span>


<span class="n">f</span> <span class="o">=</span> <span class="n">Flow</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="s">'http'</span><span class="p">).</span><span class="n">add</span><span class="p">(</span><span class="n">uses</span><span class="o">=</span><span class="n">MyExec</span><span class="p">)</span>
<span class="n">f</span><span class="p">.</span><span class="n">expose_endpoint</span><span class="p">(</span><span class="s">'/foo'</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="s">'my endpoint'</span><span class="p">)</span>
<span class="k">with</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="p">.</span><span class="n">block</span><span class="p">()</span>
</code></pre></div></div>

<p>Эндпоинты можно скрыть для http или открыть для CORS. Кроме того, jina работает на [<a href="uvicorn" title="Uvicorn">uvicorn</a>] и параметры можно передачь во флоу.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Flow</span>

<span class="c1"># hide default endpoints
</span><span class="n">f</span> <span class="o">=</span> <span class="n">Flow</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="s">'http'</span><span class="p">,</span> <span class="n">no_debug_endpoints</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">no_crud_endpoints</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># enable cors
</span><span class="n">f</span> <span class="o">=</span> <span class="n">Flow</span><span class="p">(</span><span class="n">cors</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="s">'http'</span><span class="p">)</span>

<span class="c1"># advanced options
</span><span class="n">f</span> <span class="o">=</span> <span class="n">Flow</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="s">'http'</span><span class="p">,</span> <span class="n">uvicorn_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s">'loop'</span><span class="p">:</span> <span class="s">'asyncio'</span><span class="p">,</span> <span class="s">'http'</span><span class="p">:</span> <span class="s">'httptools'</span><span class="p">})</span>
</code></pre></div></div>

<p>Для подключения TLS нужно задать серитфикаты</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">f</span> <span class="o">=</span> <span class="n">Flow</span><span class="p">(</span>
    <span class="n">port</span><span class="o">=</span><span class="n">PORT</span><span class="p">,</span>
    <span class="n">ssl_certfile</span><span class="o">=</span><span class="s">'path/to/certfile.crt'</span><span class="p">,</span>
    <span class="n">ssl_keyfile</span><span class="o">=</span><span class="s">'path/to/keyfile.crt'</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></div>

<p>Дополнительно можно реализовать:</p>

<ul>
  <li>[<a href="graphql" title="Язык и система организации АПИ GraphQL">graphql</a>]</li>
  <li>контроль числа запросов</li>
  <li>таймауты</li>
  <li>генерация спецификаций для деплоя, к примеру композ или кубернетис</li>
</ul>

<h3 id="client"><a href="https://docs.jina.ai/fundamentals/flow/client/">Client</a></h3>

<p>Предназначен для доступа к серверу.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Flow</span>

<span class="n">PORT</span> <span class="o">=</span> <span class="mi">1234</span>
<span class="n">PROTOCOL</span> <span class="o">=</span> <span class="s">'grpc'</span>  <span class="c1"># one of 'grpc', 'http', 'websocket'
</span>
<span class="k">with</span> <span class="n">Flow</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="n">PORT</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="n">PROTOCOL</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="p">.</span><span class="n">block</span><span class="p">()</span>

<span class="p">...</span>

<span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Client</span>

<span class="n">Client</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">'http://my.awesome.flow:1234'</span><span class="p">)</span>
<span class="n">Client</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">'ws://my.awesome.flow:1234'</span><span class="p">)</span>
<span class="n">Client</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">'grpc://my.awesome.flow:1234'</span><span class="p">)</span>
</code></pre></div></div>

<p>Через <code class="language-plaintext highlighter-rouge">client.post</code> можно отправить данные</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">docarray</span> <span class="kn">import</span> <span class="n">Document</span><span class="p">,</span> <span class="n">DocumentArray</span>

<span class="n">d1</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="s">'hello'</span><span class="p">)</span>
<span class="n">d2</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="s">'world'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">doc_gen</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">Document</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="s">f'hello </span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="n">PORT</span><span class="p">)</span>

<span class="n">client</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'/endpoint'</span><span class="p">,</span> <span class="n">d1</span><span class="p">)</span>  <span class="c1"># Single Document
</span>
<span class="n">client</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'/endpoint'</span><span class="p">,</span> <span class="p">[</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">])</span>  <span class="c1"># List of Documents
</span>
<span class="n">client</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'/endpoint'</span><span class="p">,</span> <span class="n">doc_gen</span><span class="p">)</span>  <span class="c1"># Document generator
</span>
<span class="n">client</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'/endpoint'</span><span class="p">,</span> <span class="n">DocumentArray</span><span class="p">([</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">]))</span>  <span class="c1"># DocumentArray
</span>
<span class="n">client</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'/endpoint'</span><span class="p">)</span>  <span class="c1"># Empty
</span></code></pre></div></div>

<p>или параметры</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">docarray</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Client</span><span class="p">,</span> <span class="n">Executor</span><span class="p">,</span> <span class="n">Flow</span><span class="p">,</span> <span class="n">requests</span>

<span class="k">class</span> <span class="nc">MyExecutor</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>

    <span class="o">@</span><span class="n">requests</span>
    <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="s">'hello'</span><span class="p">])</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">Flow</span><span class="p">().</span><span class="n">add</span><span class="p">(</span><span class="n">uses</span><span class="o">=</span><span class="n">MyExecutor</span><span class="p">)</span>

<span class="k">with</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="n">f</span><span class="p">.</span><span class="n">port</span><span class="p">)</span>
    <span class="n">client</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'/'</span><span class="p">,</span> <span class="n">Document</span><span class="p">(),</span> <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s">'hello'</span><span class="p">:</span> <span class="s">'world'</span><span class="p">})</span>
</code></pre></div></div>

<p>Можно отправлять асинхронно или бачами (во время индексации Сдшуте может отправить в поток до тысяч или миллионов документов. Эти документы внутренне объединяются в запрос, обеспечивая меньший объем памяти и более быстрое время отклика благодаря функциям обратного вызова. Размер этих пакетов можно контролировать с помощью ключевого слова request_size. Размер запроса по умолчанию — 100 документов. Оптимальный размер будет зависеть от вашего варианта использования.)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># asyncio
</span><span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">from</span> <span class="nn">docarray</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Client</span><span class="p">,</span> <span class="n">Flow</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">async_inputs</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">Document</span><span class="p">()</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">run_client</span><span class="p">(</span><span class="n">port</span><span class="p">):</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="n">asyncio</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">for</span> <span class="n">resp</span> <span class="ow">in</span> <span class="n">client</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'/'</span><span class="p">,</span> <span class="n">async_inputs</span><span class="p">,</span> <span class="n">request_size</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">)</span>

<span class="k">with</span> <span class="n">Flow</span><span class="p">()</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>  <span class="c1"># Using it as a Context Manager will start the Flow
</span>    <span class="n">asyncio</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">run_client</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">port</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># batch
</span><span class="kn">from</span> <span class="nn">docarray</span> <span class="kn">import</span> <span class="n">Document</span><span class="p">,</span> <span class="n">DocumentArray</span>
<span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Flow</span><span class="p">,</span> <span class="n">Client</span>

<span class="k">with</span> <span class="n">Flow</span><span class="p">()</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="n">f</span><span class="p">.</span><span class="n">port</span><span class="p">)</span>
    <span class="n">client</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'/'</span><span class="p">,</span> <span class="n">DocumentArray</span><span class="p">(</span><span class="n">Document</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)),</span> <span class="n">request_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></div>

<p>Кроме того, можно отправить запрос отдельному экзекьютору из флоу</p>

<p>После выполнения <code class="language-plaintext highlighter-rouge">post()</code> можно реализовать колбеки. Доступны следующие опции:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">on_done</code> is executed after successful completion of <code class="language-plaintext highlighter-rouge">post()</code></li>
  <li><code class="language-plaintext highlighter-rouge">on_error</code> is executed whenever an error occurs in <code class="language-plaintext highlighter-rouge">post()</code></li>
  <li><code class="language-plaintext highlighter-rouge">on_always</code> is always performed, no matter the success or failure of <code class="language-plaintext highlighter-rouge">post()</code></li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Flow</span><span class="p">,</span> <span class="n">Client</span>
<span class="kn">from</span> <span class="nn">docarray</span> <span class="kn">import</span> <span class="n">Document</span>


<span class="k">def</span> <span class="nf">beep</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="c1"># make a beep sound
</span>    <span class="kn">import</span> <span class="nn">sys</span>

    <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">'</span><span class="se">\a</span><span class="s">'</span><span class="p">)</span>


<span class="k">with</span> <span class="n">Flow</span><span class="p">().</span><span class="n">add</span><span class="p">()</span> <span class="k">as</span> <span class="n">f</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s">'output.txt'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="n">f</span><span class="p">.</span><span class="n">port</span><span class="p">)</span>
    <span class="n">client</span><span class="p">.</span><span class="n">post</span><span class="p">(</span>
        <span class="s">'/'</span><span class="p">,</span>
        <span class="n">Document</span><span class="p">(),</span>
        <span class="n">on_done</span><span class="o">=</span><span class="k">print</span><span class="p">,</span>
        <span class="n">on_error</span><span class="o">=</span><span class="n">beep</span><span class="p">,</span>
        <span class="n">on_always</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">.</span><span class="n">docs</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">fp</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div></div>

<p>Можно создавать кастомные колбеки, в иом числе и связанные с определенными ошибками.</p>

<p><code class="language-plaintext highlighter-rouge">client.post()</code> возвращает нормализованный <code class="language-plaintext highlighter-rouge">DocumentArray</code>, содержащий все документы всех запросов. Установив <code class="language-plaintext highlighter-rouge">client.post(return_responses=True)</code> можно сделать так, чтобы вместо этого возвращался список ответов <code class="language-plaintext highlighter-rouge">DataRequests</code>. Если предоставлен колбек, результаты не будут возвращены.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Flow</span><span class="p">,</span> <span class="n">Client</span>
<span class="kn">from</span> <span class="nn">docarray</span> <span class="kn">import</span> <span class="n">Document</span>

<span class="k">with</span> <span class="n">Flow</span><span class="p">()</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="n">f</span><span class="p">.</span><span class="n">port</span><span class="p">)</span>
    <span class="n">docs</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s">''</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">Document</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s">'Hi there!'</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="n">docs</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">docs</span><span class="p">.</span><span class="n">texts</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">DocumentArray</span> <span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="n">at</span> <span class="mi">140619524357664</span><span class="o">&gt;</span>
<span class="p">[</span><span class="s">'Hi there!'</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Flow</span><span class="p">,</span> <span class="n">Client</span>
<span class="kn">from</span> <span class="nn">docarray</span> <span class="kn">import</span> <span class="n">Document</span>

<span class="k">with</span> <span class="n">Flow</span><span class="p">()</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="n">f</span><span class="p">.</span><span class="n">port</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s">''</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">Document</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s">'Hi there!'</span><span class="p">),</span> <span class="n">return_responses</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">docs</span><span class="p">.</span><span class="n">texts</span><span class="p">)</span>

<span class="p">[</span><span class="o">&lt;</span><span class="n">jina</span><span class="p">.</span><span class="n">types</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">DataRequest</span> <span class="p">(</span><span class="s">'header'</span><span class="p">,</span> <span class="s">'parameters'</span><span class="p">,</span> <span class="s">'routes'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">)</span> <span class="n">at</span> <span class="mi">140619524354592</span><span class="o">&gt;</span><span class="p">]</span>
<span class="p">[</span><span class="s">'Hi there!'</span><span class="p">]</span>
</code></pre></div></div>

<h4 id="access-flow"><a href="https://docs.jina.ai/fundamentals/flow/access-flow-api/">Access Flow</a></h4>

<ul>
  <li><a href="https://docs.jina.ai/fundamentals/flow/access-flow-api/#http-access">HTTP access</a>. Потоки с открытым корс доступны через [<a href="swagger" title="Swagger">swagger</a>] ui</li>
  <li><a href="https://docs.jina.ai/fundamentals/flow/access-flow-api/#graphql">GraphQL Interface</a></li>
  <li>gRPC</li>
  <li>Websocket</li>
</ul>

<h2 id="clouds">Clouds</h2>

<ul>
  <li><a href="https://docs.jina.ai/fundamentals/executor/hub/">Hub</a> - jina hub хостинг для экзекьюторов</li>
  <li><a href="https://docs.jina.ai/fundamentals/jcloud/">JCloud</a> - хостинг для jina projects</li>
</ul>

<h2 id="аналоги">Аналоги</h2>

<ul>
  <li><a href="https://github.com/mlflow/mlflow/">MLFlow</a> Machine Learning Lifecycle Platform</li>
  <li><a href="https://github.com/kubeflow/kubeflow">KubeFlow</a> the cloud-native platform for machine learning operations - pipelines, training and deployment</li>
  <li><a href="https://github.com/ray-project/ray">RayWorkflow</a> provides a simple, universal API for building distributed applications, <a href="https://docs.ray.io/en/latest/workflows/concepts.html">дока</a></li>
  <li><a href="https://github.com/SeldonIO/seldon-core">seldon-core</a> converts your machine-learning models (Tensorflow, Pytorch, H2o, etc.) or language wrappers (Python, Java, etc.) into production REST/GRPC microservices.</li>
</ul>

<h2 id="деплой-с-docker-compose">Деплой с [<a href="docker-compose" title="Docker compose">docker-compose</a>]</h2>

<p><a href="https://docs.jina.ai/how-to/docker-compose/">ссылка</a></p>

<h2 id="cli"><a href="https://docs.jina.ai/cli">cli</a></h2>

<p>Еще ссылки:</p>

<ul>
  <li><a href="https://docs.jina.ai/">Документация jina</a></li>
  <li><a href="https://docarray.jina.ai/">Документация DocArray</a> [<a href="docarray" title="Docarray python">docarray</a>]</li>
  <li><a href="https://docs.jina.ai/get-started/install/docker/">jina docker images</a></li>
  <li><a href="https://docs.jina.ai/how-to/">tutorials</a></li>
  <li>[<a href="../lists/docker" title="Docker">docker</a>]</li>
  <li>[<a href="../lists/machine-learning" title="Алгоритмы машинного обучения">machine-learning</a>]</li>
</ul>


  </div>
</article>


    </main>

    <footer role="banner">
<div class="border-top-thin clearfix mt-2 mt-lg-4">
    <div class="container mx-auto px-2">
      <p class="col-8 sm-width-full left py-2 mb-0"><a href="/myknowlegebase/">My knowledge base</a> проект поддерживается <a class="text-accent" href="https://github.com/KonstantinKlepikov">KonstantinKlepikov</a></p>
      <ul class="list-reset right clearfix sm-width-full py-2 mb-2 mb-lg-0">
        <li class="inline-block mr-1">
          <a href="https://twitter.com/share" class="twitter-share-button" data-hashtags="My knowledge base">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
        </li>
      </ul>
    </div>
  </div>
</footer>

  </body>

</html>

<script type="text/javascript">
  // Hack: Replace page-link with "Page Title"
  document.querySelectorAll(".markdown-body a[title]").forEach((a) => {
    a.innerText = a.title;
  });
  // Hack: Remove .md extension from wikilinks to get the html in jekyll
  document.querySelectorAll("a").forEach(l => {
    if (l.href.endsWith('.md')) {
      l.href = l.href.substring(0, l.href.length-3)
    }
  })
</script>