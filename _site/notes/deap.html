<!DOCTYPE html>
<html lang="ru-RU">

<html>

  <head>

    <meta charset="UTF-8">
    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>DEAP - генетические алгоритмы на python | My knowlege base</title>
<meta name="generator" content="Jekyll v3.8.7" />
<meta property="og:title" content="DEAP - генетические алгоритмы на python" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Использование фреймворка DEAP для эволюционной оптимизации" />
<meta property="og:description" content="Использование фреймворка DEAP для эволюционной оптимизации" />
<link rel="canonical" href="https://konstantinklepikov.github.io/myknowlegebase/notes/deap.html" />
<meta property="og:url" content="https://konstantinklepikov.github.io/myknowlegebase/notes/deap.html" />
<meta property="og:site_name" content="My knowlege base" />
<script type="application/ld+json">
{"@type":"WebPage","url":"https://konstantinklepikov.github.io/myknowlegebase/notes/deap.html","headline":"DEAP - генетические алгоритмы на python","description":"Использование фреймворка DEAP для эволюционной оптимизации","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="preload" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap" as="style"
        type="text/css" crossorigin>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    
    
    <link rel="stylesheet" href="https://konstantinklepikov.github.io/myknowlegebase/assets/css/style.css">

    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->


  <!-- Yandex.Metrika counter -->
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(53548570, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true
    });
  </script>
  <noscript><div><img src="https://mc.yandex.ru/watch/53548570" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-139620627-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-139620627-1');
  </script>


<!-- Favicon -->
<link rel="icon" href="/myknowlegebase/assets/img/favicon.ico" type="image/x-icon">
<link rel="shortcut icon" href="/myknowlegebase/assets/img/favicon.ico" type="image/x-icon">

<!-- Math support -->
<!-- Mathjax Support -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>

<!-- end custom head snippets -->

</head>

  <body>

    <header class="page-header" role="banner">
    <h1 class="project-name">My knowlege base</h1>
    <h2 class="project-tagline">Мои заметки о программировании, data science и алгоритмах, собранные в процессе обучения</h2>
    <p class="project-tagline">Блог автора: <a class="project-tagline header-links" href="https://konstantinklepikov.github.io/">My deep learning</a></p>
</header>

    <main id="content" class="main-content" role="main">

      <p><a href="/myknowlegebase/">>>> На главную <<<</a></p>

<h1 id="deap---генетические-алгоритмы-на-python">DEAP - генетические алгоритмы на python</h1>

<h2 id="основные-термины">Основные термины</h2>

<p><strong>Ген</strong> - вектор значений индивидуума, обучаемый алгоритмом</p>

<p><strong>Популяция</strong> - коллекция генов</p>

<p><strong>Функция приспособленности</strong> - или целевая функция. Функция, которую мы оптимизируем. Индивидуумы, для которых ф-ия дает наилучшую оценку будут отобраны генетическим алгоритмом.</p>

<h2 id="класс-creator">Класс creator</h2>

<p>Метафабрика. позволяющая расширять существующие классы. Используется обычно для создания классов <code class="language-plaintext highlighter-rouge">Fitness</code> и <code class="language-plaintext highlighter-rouge">Individual</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">deap</span> <span class="kn">import</span> <span class="n">creator</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">tools</span><span class="p">,</span> <span class="n">algorithms</span>

<span class="k">class</span> <span class="nc">Employee</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="n">creator</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="s">"Developer"</span><span class="p">,</span> <span class="n">Employee</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s">"Developer"</span><span class="p">,</span> <span class="n">programmingLanguages</span><span class="o">=</span><span class="nb">set</span><span class="p">)</span>

<span class="n">help</span><span class="p">(</span><span class="n">creator</span><span class="p">.</span><span class="n">Developer</span><span class="p">)</span>
</code></pre></div></div>

<pre><code class="language-txt">    Help on class Developer in module deap.creator:
    
    class Developer(__main__.Employee)
     |  Developer(*args, **kargs)
     |  
     |  Method resolution order:
     |      Developer
     |      __main__.Employee
     |      builtins.object
     |  
     |  Methods defined here:
     |  
     |  __init__ = initType(self, *args, **kargs)
     |      Replace the __init__ function of the new type, in order to
     |      add attributes that were defined with **kargs to the instance.
     |  
     |  ----------------------------------------------------------------------
     |  Data and other attributes defined here:
     |  
     |  position = 'Developer'
     |  
     |  ----------------------------------------------------------------------
     |  Data descriptors inherited from __main__.Employee:
     |  
     |  __dict__
     |      dictionary for instance variables (if defined)
     |  
     |  __weakref__
     |      list of weak references to the object (if defined)
</code></pre>

<h2 id="fitness">Fitness</h2>

<p>В этом классе инкапсулированы значения приспособленности. Приспособленность в deap можно определять по нескольким компонентам (целями). у каждой из которых есть вес. Комбинация весов определяет поведение или стратегию приспособления в конкретной задаче</p>

<p>base.Fitness - абстрактный класс. содержащий кортеж <code class="language-plaintext highlighter-rouge">weights</code>. Чтобы определить стратегию, кортежу наджо присвоить значения.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">creator</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="s">'FitnessMax'</span><span class="p">,</span> <span class="n">base</span><span class="p">.</span><span class="n">Fitness</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,))</span>

<span class="n">help</span><span class="p">(</span><span class="n">creator</span><span class="p">.</span><span class="n">FitnessMax</span><span class="p">)</span>
</code></pre></div></div>

<pre><code class="language-txt">    Help on class FitnessMax in module deap.creator:
    
    class FitnessMax(deap.base.Fitness)
     |  FitnessMax(*args, **kargs)
     |  
     |  The fitness is a measure of quality of a solution. If *values* are
     |  provided as a tuple, the fitness is initialized using those values,
     |  otherwise it is empty (or invalid).
     |  
     |  :param values: The initial values of the fitness as a tuple, optional.
     |  
     |  Fitnesses may be compared using the ``&gt;``, ``&lt;``, ``&gt;=``, ``&lt;=``, ``==``,
     |  ``!=``. The comparison of those operators is made lexicographically.
     |  Maximization and minimization are taken care off by a multiplication
     |  between the :attr:`weights` and the fitness :attr:`values`. The comparison
     |  can be made between fitnesses of different size, if the fitnesses are
     |  equal until the extra elements, the longer fitness will be superior to the
     |  shorter.
     |  
     |  Different types of fitnesses are created in the :ref:`creating-types`
     |  tutorial.
     |  
     |  .. note::
     |     When comparing fitness values that are **minimized**, ``a &gt; b`` will
     |     return :data:`True` if *a* is **smaller** than *b*.
     |  
     |  Method resolution order:
     |      FitnessMax
     |      deap.base.Fitness
     |      builtins.object
     |  
     |  Methods defined here:
     |  
     |  __init__ = initType(self, *args, **kargs)
     |      Replace the __init__ function of the new type, in order to
     |      add attributes that were defined with **kargs to the instance.
     |  
     |  ----------------------------------------------------------------------
     |  Data and other attributes defined here:
     |  
     |  weights = (1.0,)
     |  
     |  ----------------------------------------------------------------------
     |  Methods inherited from deap.base.Fitness:
     |  
     |  __deepcopy__(self, memo)
     |      Replace the basic deepcopy function with a faster one.
     |      
     |      It assumes that the elements in the :attr:`values` tuple are
     |      immutable and the fitness does not contain any other object
     |      than :attr:`values` and :attr:`weights`.
     |  
     |  __eq__(self, other)
     |      Return self==value.
     |  
     |  __ge__(self, other)
     |      Return self&gt;=value.
     |  
     |  __gt__(self, other)
     |      Return self&gt;value.
     |  
     |  __hash__(self)
     |      Return hash(self).
     |  
     |  __le__(self, other)
     |      Return self&lt;=value.
     |  
     |  __lt__(self, other)
     |      Return self&lt;value.
     |  
     |  __ne__(self, other)
     |      Return self!=value.
     |  
     |  __repr__(self)
     |      Return the Python code to build a copy of the object.
     |  
     |  __str__(self)
     |      Return the values of the Fitness object.
     |  
     |  delValues(self)
     |  
     |  dominates(self, other, obj=slice(None, None, None))
     |      Return true if each objective of *self* is not strictly worse than
     |      the corresponding objective of *other* and at least one objective is
     |      strictly better.
     |      
     |      :param obj: Slice indicating on which objectives the domination is
     |                  tested. The default value is `slice(None)`, representing
     |                  every objectives.
     |  
     |  getValues(self)
     |  
     |  setValues(self, values)
     |  
     |  ----------------------------------------------------------------------
     |  Readonly properties inherited from deap.base.Fitness:
     |  
     |  valid
     |      Assess if a fitness is valid or not.
     |  
     |  ----------------------------------------------------------------------
     |  Data descriptors inherited from deap.base.Fitness:
     |  
     |  __dict__
     |      dictionary for instance variables (if defined)
     |  
     |  __weakref__
     |      list of weak references to the object (if defined)
     |  
     |  values
     |      Fitness values. Use directly ``individual.fitness.values = values`` in order to set the fitness and ``del individual.fitness.values`` in order to clear (invalidate) the fitness. The (unweighted) fitness can be directly accessed via ``individual.fitness.values``.
     |  
     |  ----------------------------------------------------------------------
     |  Data and other attributes inherited from deap.base.Fitness:
     |  
     |  wvalues = ()
</code></pre>

<p>В данном случае стратегия <code class="language-plaintext highlighter-rouge">FitnessMax</code> - максимизировать приспособленность индивидумов с единственной целью. Минимизация будет выглядеть так:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">creator</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="s">'FitnessMin'</span><span class="p">,</span> <span class="n">base</span><span class="p">.</span><span class="n">Fitness</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,))</span>
</code></pre></div></div>

<p>Множество целей. Первые две компоненты максимизируются, третья минимизируется. Важность компонент следует слева направо</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">creator</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="s">'FitnessCompound'</span><span class="p">,</span> <span class="n">base</span><span class="p">.</span><span class="n">Fitness</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
</code></pre></div></div>

<p><strong>Кортеж values</strong> хранит сами значения приспособленности. Эти значения дает отдельно определяемая функция, которую обычно называют <code class="language-plaintext highlighter-rouge">evaluate()</code>. Кортеж содержит по одному значению для каждой функуции (цели).</p>

<p><strong>Третий кортеж wvalues</strong> содержит взвешенные значени, полученные перемножением <code class="language-plaintext highlighter-rouge">values</code> и <code class="language-plaintext highlighter-rouge">weights</code>. Это используется для сравнения индивидуумов.</p>

<p>wvalues можно сравнивать лексикографически с помощью операторов <code class="language-plaintext highlighter-rouge">&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;</code>, <code class="language-plaintext highlighter-rouge">&gt;=</code>, <code class="language-plaintext highlighter-rouge">&lt;=</code>, <code class="language-plaintext highlighter-rouge">==</code>, <code class="language-plaintext highlighter-rouge">!=</code></p>

<h2 id="individual">Individual</h2>

<p>С помощью этого класса определяются индивидуумы, образующие популяцию. В данном случае все гены индивидумов будут иметь тип лист, а класс каждого индивидума будет содержать экземляр <code class="language-plaintext highlighter-rouge">FitnessMax</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">creator</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="s">'Individual'</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">fitness</span><span class="o">=</span><span class="n">creator</span><span class="p">.</span><span class="n">FitnessMax</span><span class="p">)</span>

<span class="n">help</span><span class="p">(</span><span class="n">creator</span><span class="p">.</span><span class="n">Individual</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    Help on class Individual in module deap.creator:
    
    class Individual(builtins.list)
     |  Individual(*args, **kargs)
     |  
     |  Built-in mutable sequence.
     |  
     |  If no argument is given, the constructor creates a new empty list.
     |  The argument must be an iterable if specified.
     |  
     |  Method resolution order:
     |      Individual
     |      builtins.list
     |      builtins.object
     |  
     |  Methods defined here:
     |  
     |  __init__ = initType(self, *args, **kargs)
     |      Replace the __init__ function of the new type, in order to
     |      add attributes that were defined with **kargs to the instance.
     |  
     |  ----------------------------------------------------------------------
     |  Data descriptors defined here:
     |  
     |  __dict__
     |      dictionary for instance variables (if defined)
     |  
     |  __weakref__
     |      list of weak references to the object (if defined)
     |  
     |  ----------------------------------------------------------------------
     |  Methods inherited from builtins.list:
     |  
     |  __add__(self, value, /)
     |      Return self+value.
     |  
     |  __contains__(self, key, /)
     |      Return key in self.
     |  
     |  __delitem__(self, key, /)
     |      Delete self[key].
     |  
     |  __eq__(self, value, /)
     |      Return self==value.
     |  
     |  __ge__(self, value, /)
     |      Return self&gt;=value.
     |  
     |  __getattribute__(self, name, /)
     |      Return getattr(self, name).
     |  
     |  __getitem__(...)
     |      x.__getitem__(y) &lt;==&gt; x[y]
     |  
     |  __gt__(self, value, /)
     |      Return self&gt;value.
     |  
     |  __iadd__(self, value, /)
     |      Implement self+=value.
     |  
     |  __imul__(self, value, /)
     |      Implement self*=value.
     |  
     |  __iter__(self, /)
     |      Implement iter(self).
     |  
     |  __le__(self, value, /)
     |      Return self&lt;=value.
     |  
     |  __len__(self, /)
     |      Return len(self).
     |  
     |  __lt__(self, value, /)
     |      Return self&lt;value.
     |  
     |  __mul__(self, value, /)
     |      Return self*value.
     |  
     |  __ne__(self, value, /)
     |      Return self!=value.
     |  
     |  __repr__(self, /)
     |      Return repr(self).
     |  
     |  __reversed__(self, /)
     |      Return a reverse iterator over the list.
     |  
     |  __rmul__(self, value, /)
     |      Return value*self.
     |  
     |  __setitem__(self, key, value, /)
     |      Set self[key] to value.
     |  
     |  __sizeof__(self, /)
     |      Return the size of the list in memory, in bytes.
     |  
     |  append(self, object, /)
     |      Append object to the end of the list.
     |  
     |  clear(self, /)
     |      Remove all items from list.
     |  
     |  copy(self, /)
     |      Return a shallow copy of the list.
     |  
     |  count(self, value, /)
     |      Return number of occurrences of value.
     |  
     |  extend(self, iterable, /)
     |      Extend list by appending elements from the iterable.
     |  
     |  index(self, value, start=0, stop=9223372036854775807, /)
     |      Return first index of value.
     |      
     |      Raises ValueError if the value is not present.
     |  
     |  insert(self, index, object, /)
     |      Insert object before index.
     |  
     |  pop(self, index=-1, /)
     |      Remove and return item at index (default last).
     |      
     |      Raises IndexError if list is empty or index is out of range.
     |  
     |  remove(self, value, /)
     |      Remove first occurrence of value.
     |      
     |      Raises ValueError if the value is not present.
     |  
     |  reverse(self, /)
     |      Reverse *IN PLACE*.
     |  
     |  sort(self, /, *, key=None, reverse=False)
     |      Sort the list in ascending order and return None.
     |      
     |      The sort is in-place (i.e. the list itself is modified) and stable (i.e. the
     |      order of two equal elements is maintained).
     |      
     |      If a key function is given, apply it once to each list item and sort them,
     |      ascending or descending, according to their function values.
     |      
     |      The reverse flag can be set to sort in descending order.
     |  
     |  ----------------------------------------------------------------------
     |  Static methods inherited from builtins.list:
     |  
     |  __new__(*args, **kwargs) from builtins.type
     |      Create and return a new object.  See help(type) for accurate signature.
     |  
     |  ----------------------------------------------------------------------
     |  Data and other attributes inherited from builtins.list:
     |  
     |  __hash__ = None
</code></pre></div></div>

<h2 id="toolbox">Toolbox</h2>

<p>Это контейнер для функций и операторов и позволяет создавать новые операторы путем назначения псевдонимов</p>

<p>Первым аргументом реигстрируем имя ф-ии. Вторым передаем ей выполняемую функцию. Остальные рагументы - необязательны (аргументы выполняемой ф-ии)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">sum_of_two</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="n">toolbox</span> <span class="o">=</span> <span class="n">base</span><span class="p">.</span><span class="n">Toolbox</span><span class="p">()</span>
<span class="n">toolbox</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="s">'increment_by_five'</span><span class="p">,</span> <span class="n">sum_of_two</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">toolbox</span><span class="p">.</span><span class="n">increment_by_five</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span><span class="mi">15</span>
</code></pre></div></div>

<h2 id="создание-генетических-операторов">Создание генетических операторов</h2>

<p>модуль <code class="language-plaintext highlighter-rouge">tools</code> содержит полезные функции для осуществления операций отбора, включая скрещивание и мутации, а так-же утилиты для инициализации. Поэтому <code class="language-plaintext highlighter-rouge">Toolbox</code> используется в основном для этого</p>

<p>В данном случае:</p>

<ul>
  <li>создан оператор <code class="language-plaintext highlighter-rouge">tools.select</code> использующий турнирный отбор с аргументом 3 (размер тиурнира)</li>
  <li>создан оператор <code class="language-plaintext highlighter-rouge">mate</code> как псевдоним ф-ии <code class="language-plaintext highlighter-rouge">cxTwoPoint()</code>, выполняющей двухточечное скрещивание</li>
  <li>создан оператор <code class="language-plaintext highlighter-rouge">mutate</code> c операцией инвертирования бита и вероятностью 0.02</li>
</ul>

<p>Функции отбора хранятся в <code class="language-plaintext highlighter-rouge">selection.py</code>. Функции скрещивания в <code class="language-plaintext highlighter-rouge">crossower.py</code>. Функции мутации в <code class="language-plaintext highlighter-rouge">mutation.py</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">toolbox</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="s">'select'</span><span class="p">,</span> <span class="n">tools</span><span class="p">.</span><span class="n">selTournament</span><span class="p">,</span> <span class="n">tournize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">toolbox</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="s">'mate'</span><span class="p">,</span> <span class="n">tools</span><span class="p">.</span><span class="n">cxESTwoPoint</span><span class="p">)</span>
<span class="n">toolbox</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="s">'mutate'</span><span class="p">,</span> <span class="n">tools</span><span class="p">.</span><span class="n">mutFlipBit</span><span class="p">,</span> <span class="n">indpb</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="создание-популяции">Создание популяции</h2>

<p><code class="language-plaintext highlighter-rouge">init.py</code> содержит несколько ф-ий полезных для создания и иницализации популяции.</p>

<p>Функцияя <code class="language-plaintext highlighter-rouge">initRepeat()</code> принимает три аргумента:</p>

<ul>
  <li>тип контейнера результирующих объектов</li>
  <li>ф-ия. генерирующая объекты, которые помещаются в контейнер</li>
  <li>сколько объектов генерировать</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">random</span>
<span class="n">toolbox</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="s">'zero_or_one'</span><span class="p">,</span> <span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">rnd</span> <span class="o">=</span> <span class="n">tools</span><span class="p">.</span><span class="n">initRepeat</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">toolbox</span><span class="p">.</span><span class="n">zero_or_one</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">rnd</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">...,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</code></pre></div></div>

<h2 id="вычисление-приспособленности">Вычисление приспособленности</h2>

<p>значение приспособленности обычно возвращаются отдельно определенной ф-ией, которая регистрируется в <code class="language-plaintext highlighter-rouge">toolbox</code> как <code class="language-plaintext highlighter-rouge">evaluate</code> (соглашение)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">some_calc</span><span class="p">(</span><span class="n">nums</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">nums</span>

<span class="n">toolbox</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="s">'evaluate'</span><span class="p">,</span> <span class="n">some_calc</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="statistics">Statistics</h2>

<p>Класс <code class="language-plaintext highlighter-rouge">tools.Statistics</code> позволяет собират ьстатистику. задавая ф-ию, применяемую к данным, для которых вычисляется статистика. Например для случая, когда популяция является данными, функция извлекающая приспособленность каждого индивидуума и зарегистрированные методы</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">stats</span> <span class="o">=</span> <span class="n">tools</span><span class="p">.</span><span class="n">Statistics</span><span class="p">(</span><span class="k">lambda</span> <span class="n">ind</span><span class="p">:</span> <span class="n">inf</span><span class="p">.</span><span class="n">fitness</span><span class="p">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">stats</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="s">"max"</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="nb">max</span><span class="p">)</span>
<span class="n">stats</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="s">"avg"</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="встроенные-алгоритмы">Встроенные алгоритмы</h2>

<p>В DEAP несколько встроенных эволюционных алгоритмов, реализующих пайплайн обучения. Пример примененеия:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">population</span><span class="p">,</span> <span class="n">logbook</span> <span class="o">=</span> <span class="n">algorithms</span><span class="p">.</span><span class="n">eaSimple</span><span class="p">(</span>
    <span class="n">population</span><span class="p">,</span> 
    <span class="n">toolbox</span><span class="p">,</span>
    <span class="n">cxpb</span><span class="o">=</span><span class="n">CONST1</span><span class="p">,</span>
    <span class="n">mutpb</span><span class="o">=</span><span class="n">CONST2</span><span class="p">,</span>
    <span class="n">ngen</span><span class="o">=</span><span class="n">CONST3</span><span class="p">,</span>
    <span class="n">stats</span><span class="o">=</span><span class="n">stats</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></div>

<h2 id="logbook">logbook</h2>

<p>логбук - собранная статистика, которую возвращает алгоритм. Ее можно извлечь методом <code class="language-plaintext highlighter-rouge">select()</code> (в данном случае как раз и используются зарегистрирвоанные нами методы сбора статы)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">max_</span><span class="p">,</span> <span class="n">mean_</span> <span class="o">=</span> <span class="n">logbook</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="s">'max'</span><span class="p">,</span> <span class="s">'avg`)
</span></code></pre></div></div>

<h2 id="зал-славы">Зал славы</h2>

<p>Класс HallOfFame модуля tools возвращает отранжированный список лучших индивидумов, даже если в процессе эволюции или отбора они были утрачены.</p>


<div class="additional-pad">
  <p><a href="/myknowlegebase/">>>> На главную <<<</a></p>
</div>


      <footer class="site-footer">
    <span class="site-footer-owner"><a href="/myknowlegebase/">My knowlege base</a> поддерживается <a href="https://github.com/KonstantinKlepikov">KonstantinKlepikov</a></span>
    <span class="site-footer-credits">Блог автора: <a href="https://konstantinklepikov.github.io/">My deep learning</a></span>
</footer>

    </main>

  </body>

</html>

<script type="text/javascript">
  // Hack: Replace page-link with "Page Title"
  document.querySelectorAll(".markdown-body a[title]").forEach((a) => {
    a.innerText = a.title;
  });
  // Hack: Remove .md extension from wikilinks to get the html in jekyll
  document.querySelectorAll("a").forEach(l => {
    if (l.href.endsWith('.md')) {
      l.href = l.href.substring(0, l.href.length-3)
    }
  })
</script>