<!DOCTYPE html>
<html lang="ru-RU">

<html>

  <head>

    <meta charset="UTF-8">
    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Mathematic in python | My knowlege base</title>
<meta name="generator" content="Jekyll v3.8.7" />
<meta property="og:title" content="Mathematic in python" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Математические операции в python" />
<meta property="og:description" content="Математические операции в python" />
<link rel="canonical" href="https://konstantinklepikov.github.io/myknowlegebase/notes/mathematic-in-python.html" />
<meta property="og:url" content="https://konstantinklepikov.github.io/myknowlegebase/notes/mathematic-in-python.html" />
<meta property="og:site_name" content="My knowlege base" />
<script type="application/ld+json">
{"@type":"WebPage","url":"https://konstantinklepikov.github.io/myknowlegebase/notes/mathematic-in-python.html","headline":"Mathematic in python","description":"Математические операции в python","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="preload" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap" as="style"
        type="text/css" crossorigin>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    
    
    <link rel="stylesheet" href="https://konstantinklepikov.github.io/myknowlegebase/assets/css/style.css">

    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->


  <!-- Yandex.Metrika counter -->
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(53548570, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true
    });
  </script>
  <noscript><div><img src="https://mc.yandex.ru/watch/53548570" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-139620627-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-139620627-1');
  </script>


<!-- Favicon -->
<link rel="icon" href="/myknowlegebase/assets/img/favicon.ico" type="image/x-icon">
<link rel="shortcut icon" href="/myknowlegebase/assets/img/favicon.ico" type="image/x-icon">

<!-- Math support -->
<!-- Mathjax Support -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>

<!-- end custom head snippets -->

</head>

  <body>

    <header role="banner">
    <div class="container">
        <h1 id="a-title"><a href="/myknowlegebase/">My knowlege base</a></h1>
        <h2 class="project-tagline">Мои заметки о программировании, data science и алгоритмах, собранные в процессе обучения</h2>
        <p>Тут собраны заметки по программированию, машинному обучению и алгоритмам, которые автор <a href=""></a> делал и продолжает делать в процессе обучения. Тысяча извинений за сумбурность записей, орфографию и изрядную долю копипасты. По сути это конспект. Более толковые статьи можно почитать в блоге <a href="https://konstantinklepikov.github.io/">my deep learning</a></p>
    </div>
</header>

    <main id="main-content" class="container" role="main">

      <h1 id="mathematic-in-python">Mathematic in python</h1>

<p>Помимо встроенных типов чисел предоставляется дополнительные классы для вычислений с повышеннйо точностью или специальных вычислений.</p>

<h2 id="decimal"><a href="https://docs.python.org/3/library/decimal.html">decimal</a></h2>

<p>Числа с фиксированной точностью и числа с плавающей точкой.</p>

<p>Десятичное число в данном модуле - это неизменяемый тип данных. Десятичное число может обладать знаком, состоять из мантисы и экспоненты. Для сохранения значимости конечные нули не усекаются.</p>

<p>Контекст вычислений определяет точность, правила округления, ограничения на экспоненты, флаги результатов операций и средства активации исключений.</p>

<p>Сигналы – это специальные условия, которые возникают в процессе вычислений и могут использоваться для вызова исключений.</p>

<p>Дробные десятичные числа представлены классом <code class="language-plaintext highlighter-rouge">Decimal</code>. Его конструктору передается одно целое число или строка. Можно использовать <code class="language-plaintext highlighter-rouge">from_float()</code> для точного преобразования числа с плавающей точкой. В последнем случае длина строки может быть значительной, так как некоторые числа с плавающей точкой невозможно точно представить в двоичной форме.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">decimal</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">decimal</span><span class="p">.</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="mi">5</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">decimal</span><span class="p">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s">'3.14'</span><span class="p">))</span>
<span class="mf">3.14</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">decimal</span><span class="p">.</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)))</span>
<span class="mf">0.1</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">decimal</span><span class="p">.</span><span class="n">Decimal</span><span class="p">.</span><span class="n">from_float</span><span class="p">(</span><span class="mf">0.1</span><span class="p">))</span>
<span class="mf">0.1000000000000000055511151231257827021181583404541015625</span>
</code></pre></div></div>

<p>Кроме того, дробное десятичное число можно задать как кортеж, содеоржащий флаг знака (0 для пложительных, 1 для отрицательных), кортеж цифр и целочисленную экспоненту.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">decimal</span><span class="p">.</span><span class="n">Decimal</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<span class="o">-</span><span class="mf">0.0111</span>
</code></pre></div></div>

<p>Над decimal можно производить теже арифметические операции, что и над стандартными числовыми типами. При этом поддерживаются и арифметические операции с целочисленными типами… а вот числа с плавающей точкой должны быть предварительно преобразованы в decimal.</p>

<p><code class="language-plaintext highlighter-rouge">Decimal</code> предоставляет специальные числовые типы <code class="language-plaintext highlighter-rouge">Infinity</code>, <code class="language-plaintext highlighter-rouge">NaN</code> и <code class="language-plaintext highlighter-rouge">0</code>. Сравнение с <code class="language-plaintext highlighter-rouge">NaN</code> на равенство всегда возвращает <code class="language-plaintext highlighter-rouge">False</code>, а на неравенство - <code class="language-plaintext highlighter-rouge">True</code>. При этом сравниваться в целях сортировки нельзя - будет поднята ошибка. Оба типа могут иметь знак + и -.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">decimal</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'Infinity'</span><span class="p">,</span> <span class="s">'NaN'</span><span class="p">,</span> <span class="s">'0'</span><span class="p">]:</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="k">print</span><span class="p">(</span><span class="n">decimal</span><span class="p">.</span><span class="n">Decimal</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">decimal</span><span class="p">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s">'-'</span> <span class="o">+</span> <span class="n">value</span><span class="p">))</span>
<span class="n">Infinity</span> <span class="o">-</span><span class="n">Infinity</span>
<span class="n">NaN</span> <span class="o">-</span><span class="n">NaN</span>
<span class="mi">0</span> <span class="o">-</span><span class="mi">0</span>
</code></pre></div></div>

<p>Полный синтаксис</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sign           ::<span class="o">=</span>  <span class="s1">'+'</span> | <span class="s1">'-'</span>
digit          ::<span class="o">=</span>  <span class="s1">'0'</span> | <span class="s1">'1'</span> | <span class="s1">'2'</span> | <span class="s1">'3'</span> | <span class="s1">'4'</span> | <span class="s1">'5'</span> | <span class="s1">'6'</span> | <span class="s1">'7'</span> | <span class="s1">'8'</span> | <span class="s1">'9'</span>
indicator      ::<span class="o">=</span>  <span class="s1">'e'</span> | <span class="s1">'E'</span>
digits         ::<span class="o">=</span>  digit <span class="o">[</span>digit]...
decimal-part   ::<span class="o">=</span>  digits <span class="s1">'.'</span> <span class="o">[</span>digits] | <span class="o">[</span><span class="s1">'.'</span><span class="o">]</span> digits
exponent-part  ::<span class="o">=</span>  indicator <span class="o">[</span>sign] digits
infinity       ::<span class="o">=</span>  <span class="s1">'Infinity'</span> | <span class="s1">'Inf'</span>
nan            ::<span class="o">=</span>  <span class="s1">'NaN'</span> <span class="o">[</span>digits] | <span class="s1">'sNaN'</span> <span class="o">[</span>digits]
numeric-value  ::<span class="o">=</span>  decimal-part <span class="o">[</span>exponent-part] | infinity
numeric-string ::<span class="o">=</span>  <span class="o">[</span>sign] numeric-value | <span class="o">[</span>sign] nan
</code></pre></div></div>

<p>Способ округления и точность decimal можно задать <a href="https://docs.python.org/3/library/decimal.html#context-objects">с помощью контекста</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">decimal</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">decimal</span><span class="p">.</span><span class="n">getcontext</span><span class="p">()</span>
<span class="n">Context</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">28</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="n">ROUND_HALF_EVEN</span><span class="p">,</span> <span class="n">Emin</span><span class="o">=-</span><span class="mi">999999</span><span class="p">,</span> <span class="n">Emax</span><span class="o">=</span><span class="mi">999999</span><span class="p">,</span>
        <span class="n">capitals</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">clamp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="p">[],</span> <span class="n">traps</span><span class="o">=</span><span class="p">[</span><span class="n">Overflow</span><span class="p">,</span> <span class="n">DivisionByZero</span><span class="p">,</span>
        <span class="n">InvalidOperation</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">decimal</span><span class="p">.</span><span class="n">getcontext</span><span class="p">().</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">7</span>       <span class="c1"># Set a new precision
</span></code></pre></div></div>

<p>Точность задается через атрибут <code class="language-plaintext highlighter-rouge">prec</code>, который можно установить в диапазоне от 1 до <code class="language-plaintext highlighter-rouge">decimal.MAX_PREC</code></p>

<p>Округление задается через атрибут  <code class="language-plaintext highlighter-rouge">rounding</code>. Доступно несколько опций:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">ROUND_CEILING</code> округлять в направлении бесконечности</li>
  <li><code class="language-plaintext highlighter-rouge">ROUND_DOWN</code> в направлении 0</li>
  <li><code class="language-plaintext highlighter-rouge">ROUND_FLOOR</code> в направлении минус бесконечности</li>
  <li><code class="language-plaintext highlighter-rouge">ROUND_HALF_DOWN</code> если последняя цифра &gt;=5 в направлении от 0, в противном случае к 0</li>
  <li><code class="language-plaintext highlighter-rouge">ROUND_HALF_EVEN</code> если последняя цифра ==5, проверить предпоследнюю. Четные цифры приводят к округлению вниз. нечетные - вверх</li>
  <li><code class="language-plaintext highlighter-rouge">ROUND_HALF_UP</code> аналогично down с той лишь разницей, что &gt;5</li>
  <li><code class="language-plaintext highlighter-rouge">ROUND_UPROUND_05UP</code> от нуля, если последняя цифра 0 или 5, в остальных случаях к 0</li>
</ul>

<p><a href="https://docs.python.org/3/library/decimal.html#rounding-modes">Подробнее</a></p>

<p>Что-бы не менять весь контекст, контекст <a href="https://docs.python.org/3/library/decimal.html#decimal.localcontext">можно задать локально через менеджера</a>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">localcontext</span>

<span class="k">with</span> <span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">ctx</span><span class="p">:</span>
    <span class="n">ctx</span><span class="p">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">42</span>   <span class="c1"># Perform a high precision calculation
</span>    <span class="n">s</span> <span class="o">=</span> <span class="n">calculate_something</span><span class="p">()</span>
<span class="n">s</span> <span class="o">=</span> <span class="o">+</span><span class="n">s</span>  <span class="c1"># Round the final result back to the default precision
</span></code></pre></div></div>

<p>Кроме того, контексты можно использовать для создания экземпляра <code class="language-plaintext highlighter-rouge">Decimal</code>, который унаследует все вводные, взятые из контекста.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">decimal</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">decimal</span><span class="p">.</span><span class="n">getcontext</span><span class="p">().</span><span class="n">copy</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pi</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="s">'3.1415'</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="s">'PI:'</span><span class="p">,</span> <span class="n">pi</span><span class="p">)</span>
<span class="n">PI</span><span class="p">:</span> <span class="mf">3.14</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="s">'RESULT:'</span><span class="p">,</span> <span class="n">decimal</span><span class="p">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s">'2.01'</span><span class="p">)</span> <span class="o">*</span> <span class="n">pi</span><span class="p">)</span>
<span class="n">RESULT</span><span class="p">:</span> <span class="mf">6.3114</span>
</code></pre></div></div>

<p>На самом деле глобальный контекст в decimal является локальным контекстом потока, поэтому каждый поток может конфигурироваться <a href="https://docs.python.org/3/library/decimal.html#working-with-threads">с использованием разных значений</a>. Кроме того, <a href="https://docs.python.org/3/library/decimal.html#signals">с помощью сигналов</a> можно устанавливать недопустимые операции, при выполнении которых будет поднята ошибка.</p>

<p>Пример с тредами на gists:</p>

<script src="https://gist.github.com/ea8eea03c89c339e45687abab77c0cb4.js"> </script>

<h2 id="fractions"><a href="https://docs.python.org/3/library/fractions.html">fractions</a></h2>

<p>Определяет операции, осуществляемые над числами из множества рациональных чисел. Апи определено классом <code class="language-plaintext highlighter-rouge">Rational</code> в модуле <code class="language-plaintext highlighter-rouge">numbers</code>. <code class="language-plaintext highlighter-rouge">fractions</code> полностью поддерживает все математические выражения</p>

<p>Есть несколько способов создания <code class="language-plaintext highlighter-rouge">fractions</code>. Во первых непосредственно задав числитель и знаменатель</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">Fraction</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="mi">1</span><span class="o">/</span><span class="mi">4</span>
</code></pre></div></div>

<p>Второй вариант - использование строкового представлениия “числитель/знаменатель”. Поддерживаются также любые строки, которые могут быть преобразованы во <code class="language-plaintext highlighter-rouge">float()</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="s">'1/4'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="s">'0.5'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="s">'5e-3'</span><span class="p">)</span>
</code></pre></div></div>

<p>Кроме того можно создавать экземпляры <code class="language-plaintext highlighter-rouge">Fraction</code> непосредственно из <code class="language-plaintext highlighter-rouge">float</code> или <code class="language-plaintext highlighter-rouge">Decimal</code>.  При этому потери точности, как в <code class="language-plaintext highlighter-rouge">Decimal</code> уже нет. Однако значения с плавающей точкой, которые не могут быть выражены точно в <code class="language-plaintext highlighter-rouge">Decimal</code> могут привести к очень большим дробям во <code class="language-plaintext highlighter-rouge">Fraction</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="mi">3602879701896397</span><span class="o">/</span><span class="mi">36028797018963968</span>
</code></pre></div></div>

<p>Есть способ этим управлять, устанавливая предельный размер значения знаменателя</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">limit_denominator</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="mi">1</span><span class="o">/</span><span class="mi">10</span>
</code></pre></div></div>

<h2 id="random"><a href="https://docs.python.org/3/library/random.html">random</a></h2>

<p>Модуль предоставялет генератор псевдослучайных чисел. основанный на Mersenne twister алгоритме. Числа, получаемые таким методом, подчиняются равномерному распределению с большим периодом повторения.</p>

<p>Функция <code class="language-plaintext highlighter-rouge">random()</code> возвращает следующее число из генерируемой последовательности. Все значения последовательности принадлежат [0, 1.0). Естественно повторные запуски приводят к разным последовательностям.</p>

<p><code class="language-plaintext highlighter-rouge">uniform()</code> позволяет сгенерировать число из выбранного интервала. В данном случае просто происходит корректировка возврата из <code class="language-plaintext highlighter-rouge">random()</code> по формуле min + (max - min) * random</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">random</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="mf">25.113356610778503</span>
</code></pre></div></div>

<p>Чтобы не получать каждый раз разные последовательности случайных чисел, генератор можно инициализировать функцией <code class="language-plaintext highlighter-rouge">seed()</code>. Сид влияет на генерацию первого числа последовательности, а с учетом ее детерменированности, по сути на всю последовательность. Если сид не задан, используется фактор определяющий случайность, специфичный для платформы или, если такого нет, системное время.</p>

<p>Кроме того, состояние генератора случайных чисел можно сериализовать. При загрузке состояния, оно будет выступать в качестве начальтной точки для продолжения процесса генерации, чято снижает вероятность получения ранее полученных значений. Все это делается с помощью <code class="language-plaintext highlighter-rouge">getstate()</code> и <code class="language-plaintext highlighter-rouge">setstate()</code></p>

<p>Случайное целое число можно получить с помощью <code class="language-plaintext highlighter-rouge">randint()</code>, указав соответствующий диапазон генерации. Числа могут быть положительные и отрицательные, первое меньше второго. <code class="language-plaintext highlighter-rouge">randrange()</code> реализует выбор из диапазона с шагом.</p>

<p><code class="language-plaintext highlighter-rouge">choice()</code> позволяет выбрать случайный элемент из последовательности. См. статью [<a href="random-choice" title="Random choice">random-choice</a>]</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">random</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">outcomes</span> <span class="o">=</span> <span class="p">{</span>
<span class="p">...</span>     <span class="s">'heads'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">...</span>     <span class="s">'tails'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">...</span> <span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sides</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">outcomes</span><span class="p">.</span><span class="n">keys</span><span class="p">())</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
    <span class="n">outcomes</span><span class="p">[</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">sides</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="s">'Heads:'</span><span class="p">,</span> <span class="n">outcomes</span><span class="p">[</span><span class="s">'heads'</span><span class="p">])</span>
<span class="n">Heads</span><span class="p">:</span> <span class="mi">4932</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="s">'Tails:'</span><span class="p">,</span> <span class="n">outcomes</span><span class="p">[</span><span class="s">'tails'</span><span class="p">])</span>
<span class="n">Tails</span><span class="p">:</span> <span class="mi">5068</span>
</code></pre></div></div>

<p>Функция <code class="language-plaintext highlighter-rouge">shuffle()</code> реализует случайный выбор <a href="https://docs.python.org/3/library/random.html#random.shuffle">с перемешиванием на месте</a>. <code class="language-plaintext highlighter-rouge">sample()</code> - реализует случайную выборку без возврата (получается список элементов заданной длины без повторов). Работает только с хешируемыми объектами и, соответственно, исходную последовательность не изменяет.</p>

<p>Инициалищзировав класс <code class="language-plaintext highlighter-rouge">Random</code> можно задать несколько состояний нескольких генераторов и управлять процессами рандомизации по отдельности. Использование системного времени ожидаемо привело к генерации одного и того же значения.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">random</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">time</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">r1</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">Random</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">r2</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">Random</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="p">...</span>     <span class="k">print</span><span class="p">(</span><span class="s">'{:04.3f}  {:04.3f}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">r1</span><span class="p">.</span><span class="n">random</span><span class="p">(),</span> <span class="n">r2</span><span class="p">.</span><span class="n">random</span><span class="p">()))</span>
<span class="mf">0.481</span>  <span class="mf">0.481</span>
<span class="mf">0.911</span>  <span class="mf">0.911</span>
<span class="mf">0.324</span>  <span class="mf">0.324</span>
</code></pre></div></div>

<p>Можно получить доступ к системному генератору случайных чисел через класс <code class="language-plaintext highlighter-rouge">SystemRandom</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">random</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">time</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">r1</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">SystemRandom</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">r2</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">SystemRandom</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="p">...</span>     <span class="k">print</span><span class="p">(</span><span class="s">'{:04.3f}  {:04.3f}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">r1</span><span class="p">.</span><span class="n">random</span><span class="p">(),</span> <span class="n">r2</span><span class="p">.</span><span class="n">random</span><span class="p">()))</span>
<span class="mf">0.379</span>  <span class="mf">0.351</span>
<span class="mf">0.625</span>  <span class="mf">0.157</span>
<span class="mf">0.508</span>  <span class="mf">0.405</span>
</code></pre></div></div>

<p>В данном слкчае <code class="language-plaintext highlighter-rouge">seed()</code> уже ничего не задает, т.к. используется системный рандомизатор.</p>

<p>Наконец, <code class="language-plaintext highlighter-rouge">random</code> включает несколько функций, позволяющих получать случайные числа не только из однородного распределения:</p>

<ul>
  <li>нормальное распределение</li>
  <li>логнормальное (логарифмы распределены нормально) распределение</li>
  <li>аппроксимирующее распределение</li>
  <li>экспоненциальное распределение</li>
  <li>круговое нормальное распределение</li>
  <li>бета-распределение, гамма-распределение и распределение Вейбулла</li>
</ul>

<p>подробнее <a href="https://docs.python.org/3/library/random.html#real-valued-distributions">смотри тут</a></p>

<h2 id="math"><a href="https://docs.python.org/3/library/math.html">math</a></h2>

<p>Математические константы и функции. Модуль поставляет ряд собственных констант, в т.ч. определяющих бесконечные числа (inf), возникающие в результате переполнения разрядов и неопределенное значение (nan).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">math</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="s">'{:.30f}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="n">pi</span><span class="p">))</span>
<span class="mf">3.141592653589793115997963468544</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="s">'{:.30f}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="n">e</span><span class="p">))</span>
<span class="mf">2.718281828459045090795598298428</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="s">'{:.30f}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="n">nan</span><span class="p">))</span>
<span class="n">nan</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="s">'{:.30f}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="n">inf</span><span class="p">))</span>
<span class="n">inf</span>
</code></pre></div></div>

<p>Часть операций приводят не к значениям <code class="language-plaintext highlighter-rouge">inf</code>, а к ошибке <code class="language-plaintext highlighter-rouge">OverflowError</code> - это связано с реализацией на C. Деление с участием бесконечных значений приводит к <code class="language-plaintext highlighter-rouge">nan</code>, который не равен никакому другому значени в т.ч. и себе. Самый простой способ проверить - функции <code class="language-plaintext highlighter-rouge">isnan()</code> и <code class="language-plaintext highlighter-rouge">isfinite()</code>.</p>

<p>Сравнение чисел с плавающей точкой подвержены ошибкам представления числа. С помощью <code class="language-plaintext highlighter-rouge">isclose()</code> можно минимизировать вероятность ошибки представления. Этот метод позволяет стравнивать с определенным допуском и. естественно, не гарантирует точное соответствие. <code class="language-plaintext highlighter-rouge">nan</code> не может быть близким ни к одному значению, вклюяая самого себя. <code class="language-plaintext highlighter-rouge">inf</code> близок только к самому себе.</p>

<p>Числа с плавающей точкой можно преобразовать в целые трямя способами. <code class="language-plaintext highlighter-rouge">trunc()</code> отбрасывает дробную часть (эквивалентно непосредственному преобразованию). <code class="language-plaintext highlighter-rouge">floor()</code> округляет до наибольшего из предшествующих целых, <code class="language-plaintext highlighter-rouge">ceil()</code> до наименьшего.</p>

<p><code class="language-plaintext highlighter-rouge">modf()</code> преобразует число с плавающей точкой в кортеж, где первое значение - цклая часть, а второе - дробная. Оба числа в кортеже - с плавающей точкой.</p>

<p><code class="language-plaintext highlighter-rouge">frexp()</code> возвращает мантиссу и экспоненту числа с плавающей точкой: x=m*2^e - возвращается m и e. Это можно использовать для переноса значений между системами. <code class="language-plaintext highlighter-rouge">ldexp()</code> осуществляет обратное преобразование.</p>

<p><code class="language-plaintext highlighter-rouge">fabs()</code> возвращает абсолютное значение (число без знака). <code class="language-plaintext highlighter-rouge">copysign()</code> возвращает знак числа. что полезно для сравнения с <code class="language-plaintext highlighter-rouge">nan</code>, у которого тоже может быть знак.</p>

<p><code class="language-plaintext highlighter-rouge">fsum()</code> реализуют более точный алгоритм вычисления суммирования над числами с плавающей точкой.</p>

<p><code class="language-plaintext highlighter-rouge">factorial()</code> повзволяет вычислить факториал для целых чисел или для чисел с плавающей точкой, если те могут быть преобразованы в целые без потери точности.</p>

<p><code class="language-plaintext highlighter-rouge">gamma()</code> считает гаммафункцию, а <code class="language-plaintext highlighter-rouge">lgamma()</code> ее натуральный логарифм.</p>

<p><code class="language-plaintext highlighter-rouge">fmod()</code> предоставляет более точную реализацию деления по модулю, чем % для чисел с плавающей точкой. Знак результата может отдличаться из-ща отличий в реализации.</p>

<p><code class="language-plaintext highlighter-rouge">gcd()</code> наибольший общий делитель</p>

<p><code class="language-plaintext highlighter-rouge">pow()</code> возводит в степень (возвращает float). <code class="language-plaintext highlighter-rouge">sqrt()</code> отдельно реализует квадратный корень. При этом <code class="language-plaintext highlighter-rouge">math</code> не работает с комплексными числами и корень из отрицательного числа ведет к <code class="language-plaintext highlighter-rouge">ValueError</code></p>

<p><code class="language-plaintext highlighter-rouge">log()</code> натуральный логарифм. <code class="language-plaintext highlighter-rouge">log10()</code> реализует более точный алгоритм для десятичного логарифма. <code class="language-plaintext highlighter-rouge">log2()</code> для логарифма по основанию 2. <code class="language-plaintext highlighter-rouge">log1p()</code> вычисляет ряд Ньютона-Меркатора и более точен для значений, близких к 0.</p>

<p><code class="language-plaintext highlighter-rouge">exp()</code> экспонента. <code class="language-plaintext highlighter-rouge">exp1p()</code> возвращает e^(x)-1</p>

<p>Градусы переводятся в радианы с помощью <code class="language-plaintext highlighter-rouge">radians()</code>. Обратно - <code class="language-plaintext highlighter-rouge">degrees()</code>. Тригонометрические функции (в радианах): <code class="language-plaintext highlighter-rouge">sin()</code>, <code class="language-plaintext highlighter-rouge">cos()</code>, <code class="language-plaintext highlighter-rouge">tan()</code>. Гипотянуза <code class="language-plaintext highlighter-rouge">hypot()</code>. Обратные ф-ии: <code class="language-plaintext highlighter-rouge">asin()</code>, <code class="language-plaintext highlighter-rouge">acos()</code>, <code class="language-plaintext highlighter-rouge">atan()</code>. Гиперболические функции: <code class="language-plaintext highlighter-rouge">sing()</code>, <code class="language-plaintext highlighter-rouge">cosh()</code>, <code class="language-plaintext highlighter-rouge">tanh()</code>, <code class="language-plaintext highlighter-rouge">asing()</code>, <code class="language-plaintext highlighter-rouge">acosh()</code>, <code class="language-plaintext highlighter-rouge">atanh()</code>.</p>

<p>Реализовано несколько специальных функций. Гауссова ф-ия ошибок <code class="language-plaintext highlighter-rouge">erf()</code> и <code class="language-plaintext highlighter-rouge">erfc()</code> (1 - erf).</p>

<p>В модуле <code class="language-plaintext highlighter-rouge">statistics</code> реализованы статистические функции для <code class="language-plaintext highlighter-rouge">int</code>, <code class="language-plaintext highlighter-rouge">float</code>, <code class="language-plaintext highlighter-rouge">Decimal</code>, <code class="language-plaintext highlighter-rouge">Fraction</code>: <code class="language-plaintext highlighter-rouge">mode()</code>, <code class="language-plaintext highlighter-rouge">mean()</code>, <code class="language-plaintext highlighter-rouge">median()</code> (<code class="language-plaintext highlighter-rouge">median_low()</code>, <code class="language-plaintext highlighter-rouge">median_high()</code> для устранения скошенности статистики из-за числа элементов набора данных), <code class="language-plaintext highlighter-rouge">median_grouped()</code>, а также методы для расчета дисперсии и мат.ожидания для генеральной совокупности и выборок. Еще можно считать корреляции. ковариации и лин.регрессию. Подробнее <a href="https://docs.python.org/3/library/statistics.html?highlight=statistic#module-statistics">тут</a></p>

<p><a href="https://docs.python.org/3/library/math.html">Документация модуля math</a>. Некоторео кол-во функций добавлено после 3.8</p>

<p>Смотри еще:</p>

<ul>
  <li>[<a href="../lists/python-standart-library" title="Стандартная библиотека python - список заметок">python-standart-library</a>]</li>
  <li>[<a href="../lists/numpy" title="Numpy">numpy</a>]</li>
  <li>[<a href="statmodels" title="Statmodels">statmodels</a>]</li>
</ul>



<div class="additional-pad">
  <p><a href="/myknowlegebase/">>>> На главную</a></p>
</div>


    </main>

    <footer role="banner">
    <div class="container">
        <h4><a href="/myknowlegebase/">My knowlege base</a> поддерживается <a href="https://github.com/KonstantinKlepikov">KonstantinKlepikov</a></h4>
        <h4>Блог автора: <a href="https://konstantinklepikov.github.io/">My deep learning</a></h4>
    </div>
</footer>

  </body>

</html>

<script type="text/javascript">
  // Hack: Replace page-link with "Page Title"
  document.querySelectorAll(".markdown-body a[title]").forEach((a) => {
    a.innerText = a.title;
  });
  // Hack: Remove .md extension from wikilinks to get the html in jekyll
  document.querySelectorAll("a").forEach(l => {
    if (l.href.endsWith('.md')) {
      l.href = l.href.substring(0, l.href.length-3)
    }
  })
</script>