---
description: GDScript скриптовый язык игрового редакторо GodotEngine
tags: gamedev
title: GDScript
---
[GDScripts](https://gdscript.com/) разработан как пользовательский язык сценариев для использования с игровым движком Godot.

GDScript — это объектно-ориентированный и императивный язык программирования, созданный для Godot. Его особенности включают в себя:

- Простой синтаксис, который приводит к коротким файлам.
- Молниеносная скорость компиляции и загрузки.
- Тесная интеграция редактора с завершением кода для узлов, сигналов и дополнительной информации из сцены, к которой он прикреплен.
- Встроенные типы векторов и преобразований, что делает его эффективным для интенсивного использования линейной алгебры, необходимой для игр.
- Поддерживает несколько потоков так же эффективно, как языки со статической типизацией.
- Нет сборки мусора, так как эта функция со временем мешает при создании игр. Движок подсчитывает ссылки и управляет памятью для вас в большинстве случаев по умолчанию, но вы также можете управлять памятью, если вам это нужно.
- Постепеннвый вывод. Переменные имеют динамические типы по умолчанию, но вы также можете использовать подсказки типов для строгой проверки типов.

GDScript выглядит как Python, когда вы структурируете свои блоки кода с помощью отступов, но на практике он работает иначе. Он вдохновлен несколькими языками, включая Squirrel, Lua и Python.

## Особенности

Каждый файл GDScript неявно является классом. Ключевое extendsслово определяет класс, который этот сценарий наследует или расширяет. К примеру для Sprite2D.gd запись в начале файла `extend Sprite2D` означает, что наш скрипт получит доступ ко всем свойствам и функциям ноды `Sprite2D`, включая классы, которые он расширяет, такие как `Node2D`, `CanvasItem` и `Node`.

В GDScript, если вы опустите строку с extends, ваш класс будет неявно расширять `RefCounted`, который Godot использует для управления памятью вашего приложения.

К унаследованным свойствам относятся те, которые вы можете увидеть в доке Inspector, например, `texture` ноды.

По умолчанию Инспектор отображает свойства ноды в «Заглавном регистре» с заглавными буквами, разделенными пробелом. В коде GDScript эти свойства находятся в «snake_case», то есть в нижнем регистре со словами, разделенными символом подчеркивания

```python
func _init():
    print("Hello, world!")
```

Ключевое func слово определяет новую функцию с именем `_init`. Это специальное имя для конструктора нашего класса. Механизм обращается `_init()` к каждому объекту или ноде при их создании в памяти, если вы определяете эту функцию.

```python
var speed = 400
var angular_speed = PI
```

Входящие переменные располагаются в верхней части скрипта после любых строк «расширения», но перед функциями. К примеру, каждый экземпляр ноды с прикрепленным к нему скриптом будет иметь собственную копию свойств speed и angular_speed. Ноды в Godot по умолчанию работают в радианах, но у вас есть встроенные функции и свойства, если вы предпочитаете вместо этого вычислять углы в градусах.

Игры работают, отображая множество изображений в секунду, каждое из которых называется кадром, и они делают это в цикле. Мы измеряем скорость, с которой игра создает изображения, в кадрах в секунду (FPS). Большинство игр нацелены на 60 кадров в секунду, хотя вы можете найти такие цифры, как 30 кадров в секунду на более медленных мобильных устройствах или от 90 до 240 для игр виртуальной реальности.

Разработчики движка и игры делают все возможное, чтобы обновлять игровой мир и рендерить изображения с постоянным интервалом времени, но всегда есть небольшие различия во времени рендеринга кадров. Встроенный параметр delta делает наше движение независимым от частоты кадров.

В примере ниже мы используем собственную функцию класса `Node` для вращения объекта, к которому прикреплен скрипт.

```python
func _process(delta):
    rotation += angular_speed * delta
```

`_process()`, как `_init()`, начинается с ведущего подчеркивания. По соглашению, функции Godot, то есть встроенные функции, которые вы можете переопределить для связи с движком, начинаются с символа подчеркивания.

`rotation` - это свойство класса. Оно работает с радианами и управляет вращением. `rotation += angular_speed * delta`. В редакторе кода вы можете щелкнуть, удерживая клавишу `Ctrl`, любое встроенное свойство или функцию, например `position`, `rotation`, или `_process` и открыть соответствующую документацию на новой вкладке.

Переменные внутри функции определяют локальные переменные в области действия функции.

```python
func _process(delta):
    rotation += angular_speed * delta

    var velocity = Vector2.UP.rotated(rotation) * speed

    position += velocity * delta
```

Мы определяем локальную переменную с именем `velocity`, двумерный вектор, представляющий как направление, так и скорость. Чтобы заставить узел двигаться вперед, мы начинаем с константы класса `Vector2` `Vector2.UP`, вектора, направленного вверх, и поворачиваем его, вызывая `rotated()`. Это выражение `Vector2.UP.rotated(rotation)` представляет собой вектор, указывающий вперед относительно нашего значка. Умноженное на наше `speed`, он дает нам скорость, которую мы можем использовать для перемещения ноды. `position` так же имеет встроенный тип `Vector2`

## Пользовательский ввод

У вас есть два основных инструмента для обработки ввода игрока в Godot:

- Встроенные колбеки ввода, в основном `_unhandled_input()`. Например `_process()`, это встроенная функция, которую Godot вызывает каждый раз, когда игрок нажимает клавишу. Это инструмент, который вы захотите использовать для реагирования на события, которые не происходят в каждом кадре, например, нажатие `Space` для прыжка. [Подробнее](https://docs.godotengine.org/en/stable/tutorials/inputs/inputevent.html#doc-inputevent)
- Синглтон `Input`. Синглтон — это глобально доступный объект. Godot предоставляет доступ к нескольким сценариям. Это правильный инструмент для проверки ввода в каждом кадре.

Подробный пример с `Input` [смотри тут](https://docs.godotengine.org/en/stable/getting_started/step_by_step/scripting_player_input.html).

Смотри еще:

- [Документация GDScript](https://docs.godotengine.org/en/stable/tutorials/scripting/gdscript/gdscript_basics.html#doc-gdscript)
- [[godot]]
- [[c-plus-plus]]
- [[gamedev]]

[//begin]: # "Autogenerated link references for markdown compatibility"
[godot]: godot "godot engine"
[c-plus-plus]: ../lists/c-plus-plus "Ресурсы по языку программирования С++"
[gamedev]: ../lists/gamedev "Gamedev"
[//end]: # "Autogenerated link references"