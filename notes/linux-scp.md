---
description: Обмен файлами между удаленными машинами на linux с помощью scp
tags: linux
title: Linux-scp
---
- Из локальной системы на удаленную
- С удаленной на локальную
- Между удаленными

## Sintax

```sh
scp [OPTION] [user@]SRC_HOST:]file1 [user@]DEST_HOST:]file2
```

Наиболее часто используемые опции

`-P` - Specifies the remote host ssh port.
`-p` - Preserves files modification and access times.
`-q` - Use this option if you want to suppress the progress meter and non-error messages.
`-C` - This option forces scp to compresses the data as it is sent to the destination machine.
`-r` - This option tells scp to copy directories recursively.

## Примеры

С локального на удаленный

```sh
scp file.txt remote_username@10.10.0.2:/remote/directory
```

С удаленного на локальный

```sh
scp remote_username@10.10.0.2:/remote/file.txt /local/directory
```

Между серверами

```sh
scp user1@host1.com:/files/file.txt user2@host2.com:/files
```

[Источник](https://linuxize.com/post/how-to-use-scp-command-to-securely-transfer-files/)

## Вывод лога

Иногда полезно, чтобы понять почему что-то сработало не так, как ожидалось

```sh
scp -vvv -P 30000 /somedir/somedir/file user@domain:/somedir/somedir/
```

```sh
OpenSSH_6.7p1 Debian-5+deb8u7, OpenSSL 1.0.1t  3 May 2016
debug1: Reading configuration data /etc/ssh/ssh_config
debug1: /etc/ssh/ssh_config line 19: Applying options for *
debug2: ssh_connect: needpriv 0
debug1: Connecting to 192.168.1.171 [192.168.1.171] port 30000.
debug1: Connection established.
debug1: permanently_set_uid: 0/0
debug1: key_load_public: No such file or directory
debug1: identity file /root/.ssh/identity type -1
debug1: key_load_public: No such file or directory
debug1: identity file /root/.ssh/identity-cert type -1
debug1: key_load_public: No such file or directory
debug1: identity file /root/.ssh/id_rsa type -1
debug1: key_load_public: No such file or directory
debug1: identity file /root/.ssh/id_rsa-cert type -1
debug1: key_load_public: No such file or directory
debug1: identity file /root/.ssh/id_dsa type -1
debug1: key_load_public: No such file or directory
debug1: identity file /root/.ssh/id_dsa-cert type -1
debug1: key_load_public: No such file or directory
debug1: identity file /root/.ssh/id_ecdsa type -1
debug1: key_load_public: No such file or directory
debug1: identity file /root/.ssh/id_ecdsa-cert type -1
debug1: key_load_public: No such file or directory
debug1: identity file /root/.ssh/id_ed25519 type -1
debug1: key_load_public: No such file or directory
debug1: identity file /root/.ssh/id_ed25519-cert type -1
debug1: Remote protocol version 2.0, remote software version OpenSSH_7.4p1 Debian-10+deb9u4
debug1: match: OpenSSH_7.4p1 Debian-10+deb9u4 pat OpenSSH* compat 0x04000000
debug1: Enabling compatibility mode for protocol 2.0
debug1: Local version string SSH-2.0-OpenSSH_6.7p1 Debian-5+deb8u7
debug2: fd 3 setting O_NONBLOCK
debug3: put_host_port: [192.168.1.171]:30000
debug3: load_hostkeys: loading entries for host "[192.168.1.171]:30000" from file "/root/.ssh/known_hosts"
debug3: load_hostkeys: found key type ECDSA in file /root/.ssh/known_hosts:7
debug3: load_hostkeys: loaded 1 keys
debug3: order_hostkeyalgs: prefer hostkeyalgs: ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521
debug1: SSH2_MSG_KEXINIT sent
debug1: SSH2_MSG_KEXINIT received
```

Как решать проблему с доступом для scp - [SCP permission denied error](https://cloudlinuxtech.com/scp-permission-denied/)

[[notes/linux]]

[//begin]: # "Autogenerated link references for markdown compatibility"
[notes/linux]: linux "Linux"
[//end]: # "Autogenerated link references"