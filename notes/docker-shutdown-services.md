---
description: Как убрать неработающие сервисы в docker
tags: docker
title: Docker shutdown services
---
Используя `docker service ps` можно получить простыню из погашеных сервисов. Как-то вот так:

```shell
a0w77kj0k6jfg4r9g4nz47zzg   \_ TestService2.1   TestImage:v1  W1  Shutdown       Shutdown 36 minutes ago
2of4mc63ekzbib01w3x7q6sdm   \_ TestService2.2   TestImage:v1  W2  Shutdown       Shutdown 37 minutes ago
495frrpza5pxt205o1594x54a   \_ TestService2.3   TestImage:v1  W1  Shutdown       Shutdown 36 minutes ago
57l0gsqd26u2e5gdj30w8mcn9   \_ TestService2.4   TestImage:v1  M1  Shutdown       Shutdown 36 minutes ago
baoe1i79fswb34ydwbpafg6tm   \_ TestService2.5   TestImage:v1  M3  Shutdown       Shutdown 35 minutes ago
3uxi7kwxb73z69km6s17son58   \_ TestService2.6   TestImage:v1  M2  Shutdown       Shutdown 37 minutes ago
99cg4arnt1y52nd8d422bdu49   \_ TestService2.7   TestImage:v1  M3  Shutdown       Shutdown 36 minutes ago
cq5716jqp40h6jugo1j9ilzwp   \_ TestService2.8   TestImage:v1  M1  Shutdown       Shutdown 35 minutes ago
awlz1kxbrjk51dey7frm14d8u   \_ TestService2.9   TestImage:v1  W3  Shutdown       Shutdown 35 minutes ago
4xdi9a1jweyehfqlt76uynf3i   \_ TestService2.10  TestImage:v1  M2  Shutdown       Shutdown 36 minutes ago
eo4t6i0gaj5i294fcdnb3qncq   \_ TestService2.11  TestImage:v1  W3  Shutdown       Shutdown 35 minutes ago
3ydeuxdjquulv5xj94b9ovuwu   \_ TestService2.12  TestImage:v1  W1  Shutdown       Shutdown 36 minutes ago
```

Дело в том, что это просто лог и реально как-то ресурсы на сервере не заняты. Избавиться от избыточной информации можно так:

```shell
docker swarm update --task-history-limit 2
```

Придется перезагружать стек. [Ссылка на обсуждение](https://stackoverflow.com/a/41754519/15966204)

Удалить же старые данные можно с помощью `docker system prune`. Ээто удалит all unused containers, networks, images (both dangling and unreferenced), and optionally, volumes. [Ссылка на доку](https://docs.docker.com/engine/reference/commandline/system_prune/)

```shell
docker system prune --all
```

- [[docker]]
- [[docker-swarm]]

[//begin]: # "Autogenerated link references for markdown compatibility"
[docker]: ..%2Flists%2Fdocker "Docker"
[docker-swarm]: docker-swarm "Docker swarm"
[//end]: # "Autogenerated link references"